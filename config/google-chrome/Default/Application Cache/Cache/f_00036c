function Ykc(a,b,c,d){var e=null;a.j.every(function(a,h,l){if(b&&(h>c||h==c&&l>=d))return!1;a.isEmpty()||(e=new G(l,h));return!0});return e}function Zkc(a,b,c){var d=null;a.j.some(function(a,f,h){return(f>b||f==b&&h>c)&&!a.isEmpty()?(d=new G(h,f),!0):!1});return d}bL.prototype.Ara=Z(278,function(a,b,c,d){for(var e=a-1,f=this.Qd.length;0<=e;){var h=this.Qd[e--];if(!(h.getSheetType()!=b||h.o&&d))return h}if(!c)return null;for(e=f-1;e>=a;)if(c=this.Qd[e--],!(c.getSheetType()!=b||c.o&&d))return c;return null});
function $kc(a,b,c){var d=0,e=-1;b&&(d=b.y,e=b.x);var f=null;return f=c?Ykc(a,!!b,d,e):Zkc(a,d,e)}function alc(a,b){if(!b)return null;var c=null;a.j.some(function(a,e,f){a=a.rc();for(var h=0;h<a.length;h++)if(a[h]==b)return c=new G(f,e),!0;return!1});return c}function blc(a){var b=new md;a.j.forEach(function(a){a.isEmpty()||nd(b,a.rc())});return b.rc()}function clc(a,b){var c=a.j.Ad(b.y,b.x);return c?c.rc():[]}
function dlc(a,b){var c=ss(a.k);Yb(a.K,function(a,e){var f=this.B.bo(a);Number(e)==c&&b?Fm(f,"docs-icon-comment-blank-highlighted"):Hm(f,"docs-icon-comment-blank-highlighted")},a)}function X6(a){return a.j.hasUnpostedDocos()}function elc(a,b){for(var c=[],d=0;d<b.length;d++)c.push(a.k.j[b[d]]||0);a.j.deleteDocoPositions(c)}function flc(a,b){var c={},d;for(d in b){var e=a.k.j[d]||0;e&&a.j.hasDoco(e)&&(c[e]=b[d])}return c}function glc(a){return a.k}
function Y6(a,b,c){no.call(this,10100,b);this.rb=a;this.j=b;this.k=c}C(Y6,no);Y6.prototype.nj=Jc;Y6.prototype.fd=r(35);Y6.prototype.cd=function(){var a=new Lr,b=to(this.k,this.j);K(a,1,this.rb);K(a,2,b);return a};Y6.prototype.Ti=Jc;function hlc(a){this.j={};if(a)for(var b in a)this.set(b,a[b])}hlc.prototype.get=function(a){if(!(a in this.j))throw Error("No value for key "+a);return this.j[a]};hlc.prototype.set=function(a,b){this.j[a]=b};function ilc(a){this.j=new hlc;this.o=a||null}ilc.prototype.k=function(a){try{var b=Ud(a)}catch(c){return this.o&&this.o.log(Error("Invalid serialized anchor ID")),null}return this.j.get(b.type).j(b)};ilc.prototype.Mb=function(a){return Wd(this.j.get(a.getType()).Mb(a))};function Z6(a,b){this.o=a;this.k=b}Z6.prototype.getType=g("o");function jlc(a){Z6.call(this,"range",0);this.q=a}C(jlc,Z6);jlc.prototype.j=g("q");function klc(){}ka(klc);klc.prototype.j=function(a){return new jlc(a.range)};klc.prototype.Mb=function(a){var b={};b.type=a.getType();b.uid=a.k;b.range=a.j();return b};function $6(a,b){Z6.call(this,"workbook-range",0);this.A=a;this.q=!!b}C($6,Z6);$6.prototype.j=g("A");function llc(){}ka(llc);llc.prototype.j=function(a){return new $6(a.range)};llc.prototype.Mb=function(a){var b={};b.type=a.q?"range":"workbook-range";b.uid=a.k;b.range=a.j();return b};function a7(){ilc.call(this);var a=klc.getInstance();this.j.set("range",a);a=llc.getInstance();this.j.set("workbook-range",a)}C(a7,ilc);ka(a7);a7.prototype.k=function(a){return(a=a7.G.k.call(this,a))?("range"==a.getType()&&(a=new $6(a.j(),!0)),a):null};function b7(a,b){if(!b)return null;var c=b.j();return"range"==b.getType()?(c=a.j[c],mlc(c)?c.mb().ud():null):(c=nlc(b))&&olc(plc(c))?plc(c).ud():null}function nlc(a){var b=new mo,c;try{c=ritz.getWorkbookRangeById(a.j(),!0)}catch(d){}return c?b.dd((new Ai).Q(),ritz.getWorkbookRangeById(a.j(),!0)):null}function plc(a){return new Lf(a.ib(),a.gb(),a.Cb(),a.Jb())}
function c7(a,b,c){return c?"range"==c.getType()?(b=b.j[c.j()],mlc(b)?(b=b.hb(),null!=b?qlc(a,b):null):null):(b=nlc(c))&&olc(plc(b))?qlc(a,parseInt(b.Va(),10)):null:null}function qlc(a,b){var c=xu(a,b);return c?c.Gb():null}function mlc(a){return!!a&&a.j&&olc(a.mb())}function olc(a){return!!a&&pda(a)&&Zf(a)};function rlc(a,b,c,d,e,f,h,l,m,n,p){L.call(this);this.q=a;this.ga=b;this.X=c;this.Ta=d;this.C=e;this.Na=f;this.j=h;this.Z=l;this.k=m;this.M=n;this.B=b.X;this.o=b.j;this.A=b.A;this.F=a7.getInstance();this.K={};this.I=new md;this.U=new zs(0);a=[this.U];Kb(p.k,a);a1a(p,a);p.j=Z0a(p.k);$0a(p);this.H=new S(this);slc(this)}C(rlc,L);u=rlc.prototype;u.Fga=!1;
function slc(a){var b=pb(qxa,function(a){return!txa[a]});a.H.D(a.Ta,"activity-box-closed",a.H4a).D(a.C,"mouseover",d7(a,a.kab)).D(a.C,"click",d7(a,a.jab)).D(a.C,"selectionChange",d7(a,a.lab)).D(a.C,"inputBoxActivate",d7(a,a.hab)).D(a.o,"b",d7(a,a.usb)).D(a.j,"view-comments",a.X8a).D(a.j,"comment-indicator-hover-start",a.V8a).D(a.j,"comment-indicator-hover-end",a.U8a).D(a.C,"insert_doco",a.rsb).D(new fu(a.Z),"mousewheel",a.ssb).D(a.A,["add_named_range","delete_named_range"],a.o5a).D(a.ga,"docos_change",
a.sab).D(a.M,"me",a.ZXa).D(a.o,"a",a.dva);var c=Cu(a.o);a.H.D(c,b,a.iab);a.H.D(c,["Fa"],d7(a,a.tsb));EF(a.q,Docos.EventType.HOVER,d7(a,a.g0a));EF(a.q,Docos.EventType.SELECTED,d7(a,a.qsb));EF(a.q,Docos.EventType.CREATED,a.Pta,a);EF(a.q,Docos.EventType.UNRESOLVED,a.Pta,a);EF(a.q,Docos.EventType.DELETED,a.Qta,a);EF(a.q,Docos.EventType.RESOLVED,a.Qta,a);EF(a.q,Docos.EventType.POSTED,a.A0a,a);EF(a.q,Docos.EventType.PENDING,a.m6a,a);X.Xs.bc(Cq,B(a.a3a,a));V.Tu.bc(Cq,B(a.SXa,a));V.vU.Pa("action",B(a.a5a,
a));V.wU.Pa("action",B(a.j5a,a));V.xU.Pa("action",B(a.k5a,a));a.dva()}u.dva=function(){var a=JG(this.o);V.vU.$(a);V.wU.$(a);V.xU.$(a)};u.a3a=function(){this.q.setOption(Docos.OptionName.READONLY,!this.ga.gr())};function d7(a,b){return B(function(a){this.Fga||b.call(this,a)},a)}
u.rsb=function(){var a=cB(this.o),b=rv(a);if(b&&!X6(this.q)&&!tlc(this,a,b)){var c=ritz.getNewWorkbookRangeId();this.Na.Ib(new Y6(c,a.hb(),Nf(b)));a=this.F.Mb(new $6(c));if(a=e7(this,a))this.k.dispatchEvent(new f7("te",[a],b)),this.X.j(2)}};function tlc(a,b,c){c=clc(ZA(a.B,b),c);return c.length?(b=a.q,a=a.F.Mb(c[0]),b.j.highlightDoco(b.k.j[a]||0,!0),!0):!1}u.Pta=function(a){F(a.j,function(a){g7(this,!0,a);this.I.add(a)},this)};u.Qta=function(a){F(a.j,function(a){g7(this,!1,a);this.I.remove(a)},this)};
function g7(a,b,c,d,e){c=e7(a,c);d=d||c7(a.o,a.A,c);e=e||b7(a.A,c);if(c&&d&&e){var f=ZA(a.B,d);if(b){var h=f.j.Ad(e.y,e.x)||new md;h.add(c);Eu(f.j,e.y,e.x,h)}else(h=f.j.Ad(e.y,e.x))&&h.remove(c);f.k.dispatchEvent(dt(Nf(e)));a.o.getActiveGrid()&&(d=d==cB(a.o),b?(a=a.k,(b=d?e:null)&&yf(b,a.PJ)&&a.j.add(c),a.dispatchEvent(new f7("ne",[c],b))):(a=a.k,(b=d?e:null)&&yf(b,a.PJ)&&a.j.remove(c),a.Bs==c&&(a.Bs=null),a.dispatchEvent(new f7("ve",[c],b))))}else a.k.dispatchEvent("xe")}
function e7(a,b){if(!b)return null;if(!a.K[b]){var c=a.F.k(b);c&&(a.K[b]=c)}return a.K[b]}u.usb=function(){this.k.reset()};u.g0a=function(a){a=e7(this,a.j.length?a.j[0]:null);var b=b7(this.A,a);this.k.dispatchEvent(new f7("re",[a],b))};u.A0a=ba();u.m6a=function(){var a=this.U,b=this.q.j.hasPendingContent();As(a,ys(a.ba,4,b))};u.H4a=function(){this.X.j(3)};
u.qsb=function(a){if(!X6(this.q)){var b=e7(this,a.j.length?a.j[0]:null),c=b7(this.A,b);b&&c?(this.Fga=!0,ulc(this.k,b,c)):b||a.q?this.k.reset():b||this.X.j(3)}};u.ZXa=function(){this.Fga=!1};u.lab=function(){if(!this.M.isEmpty()&&!X6(this.q)){this.X.j(3);var a=this.k,b=rv(cB(this.o));yf(a.tL,b)||!a.Bs&&!a.Vk&&yf(a.PJ,b)||(h7(a),a.dispatchEvent(new f7("qe",[],b)))}};
u.jab=function(){var a=cB(this.o);if(!X6(this.q)&&a){var b=ZA(this.B,a),c=(a=rv(a))?clc(b,a):[];c.length&&(b=this.k,c=c[0],yf(b.tL,a)?(h7(b),b.dispatchEvent(new f7("oe",[],a))):b.dispatchEvent(new f7("oe",[c],a)))}};u.hab=function(){X6(this.q)||this.k.reset()};u.tsb=function(){vlc(this.k)};u.iab=function(){vlc(this.k)};
u.o5a=function(a){var b=a.Pd;if(b&&b.j)if(mlc(b)){var c;c=b.getId();c=this.F.Mb(new jlc(c));a="add_named_range"==a.type;if(!a||this.I.contains(c)){var d=b.hb();b.Md()&&null!=d&&(d=qlc(this.o,d))&&g7(this,a,c,d,b.mb().ud())}}else this.k.dispatchEvent("xe")};
u.sab=function(a){a=a.docos||[];Mb(a);for(var b=0;b<a.length;b++){var c=this.F.Mb(new $6(a[b]));if(c){var d=e7(this,c),e;t:{e=this.B;if(d){var f=void 0;for(f in e.j){var h=e.j[f],l=alc(h,d);if(l){e={Ra:h.Gb(),coord:l};break t}}}e=null}e?(g7(this,!1,c,e.Ra,e.coord),g7(this,!0,c),this.k.dispatchEvent("xe")):this.I.contains(c)&&g7(this,!0,c)}}};
u.kab=function(a){var b=cB(this.o);if(b){if((a=a.zf)&&!cx(a)){var c=Xl(b,a.y,a.x);a=c?c.ud():a}else a=null;b=ZA(this.B,b);b=a?clc(b,a):[];c=this.k;c.j.clear();nd(c.j,b);c.PJ=a;c.dispatchEvent(new f7("pe",b,a))}};u.X8a=function(){if(!X6(this.q)){var a=this.k;if(a.Vk&&a.lR)a.lR=!1;else{var b=!a.Vk;h7(a);a.Vk=b;a.dispatchEvent("ue")}}};u.V8a=function(){if(!X6(this.q)){var a=this.k;a.Vk||(h7(a),a.lR=!0,a.Vk=!0,a.dispatchEvent("ue"))}};u.U8a=function(){if(!X6(this.q)){var a=this.k;a.Vk&&a.lR&&(h7(a),a.dispatchEvent("ue"))}};
u.ssb=function(a){a.stopPropagation()};u.CVa=function(a){var b=e7(this,a);a=c7(this.o,this.A,b);if(!b||!a)return"";b=b7(this.A,b);a=iv(a,b).getDisplayValue();500<a.length&&(a=a.substring(0,499),a+="\u2026");return a};u.SXa=function(){var a;a=this.q;var b=a.j.getLinkedDoco();if(a=a.k.k[b]||null||"")(a=e7(this,a))?(b=b7(this.A,a),ulc(this.k,a,b)):V.Tu.fireAction()};u.a5a=function(){var a=cB(this.o);tlc(this,a,rv(a))};u.j5a=function(){wlc(this,!1)};u.k5a=function(){wlc(this,!0)};
function wlc(a,b){for(var c=xlc(a,b),d=Zv(a.o),e=cB(a.o),f=rv(e),h=ZA(a.B,e),f=$kc(h,f,b),l=d;!f&&null!==l&&(l=c(l),e=l.Gb(),h=ZA(a.B,e),f=$kc(h,null,b),l=l.ue,l!=d););f&&null!==l&&(c=clc(h,f)[0],$s(a.o,l,B(a.vsb,a,e,c,f)))}function xlc(a,b){var c;c=b?B(a.o.Ara,a.o):B(a.o.rY,a.o);return function(a){return c(a,0,!0,!0)}}u.vsb=function(a,b,c){ulc(this.k,b,c);vv(a,c)};
u.J=function(){delete this.C;delete this.Z;delete this.F;delete this.K;delete this.q;delete this.B;delete this.A;delete this.Na;delete this.o;delete this.ga;N(this.U);delete this.U;N(this.M);delete this.M;N(this.k);delete this.k;N(this.H);delete this.H;rlc.G.J.call(this)};function f7(a,b,c){O.call(this,a);this.docos=b;this.o=b.length?b[0]:null;this.I=c||null}C(f7,O);function ylc(){Q.call(this);this.j=new md}C(ylc,Q);u=ylc.prototype;u.PJ=null;u.tL=null;u.Bs=null;u.Vk=!1;u.lR=!1;function ulc(a,b,c){h7(a);a.Bs=b;a.tL=c;a.dispatchEvent(new f7("se",[b],c))}function vlc(a){a.Vk||a.Bs||h7(a);a.dispatchEvent("ye")}u.reset=function(){h7(this);this.dispatchEvent("we")};function h7(a){a.PJ=null;a.j.clear();a.tL=null;a.Bs=null;a.Vk=!1;a.lR=!1}u.J=function(){delete this.PJ;delete this.j;delete this.tL;delete this.Bs;ylc.G.J.call(this)};function zlc(a,b,c,d,e,f,h,l){bz.call(this,a,b,c,d,e,f,h,2,0,l)}C(zlc,bz);zlc.prototype.Z=function(a){return WGa(this,a,"range-border cell-border waffle-docos-target-cell-border")};function Alc(a,b,c,d,e,f,h){Q.call(this);this.q=a;this.Z=b;this.A=c;this.j=d;this.C=e;this.k=f;this.I=b.X;this.o=b.j;this.F=b.A;this.H=a7.getInstance();this.ga=h||gh();this.B=new md;this.K=new md;this.X=new md;this.M=new md;this.U=new S(this);Blc(this);this.U.D(this.o,"a",this.zsb).D(this.k,"pe",this.ZYa).D(this.k,"qe",this.aZa).D(this.k,"oe",this.YYa).D(this.k,"re",this.h0a).D(this.k,"se",this.wsb).D(this.k,"ye",this.ysb).D(this.k,"we",this.xsb).D(this.k,"te",this.z0a).D(this.k,"xe",this.P7a).D(this.k,
"ne",this.f0a).D(this.k,"ve",this.i0a).D(this.k,"ue",this.p6a);Clc(this)}C(Alc,Q);u=Alc.prototype;u.Gt=null;u.d9="none";u.pda=500;u.fT=!1;u.f0a=function(a){var b=a.o;b&&Dlc(this,[b]);Elc(this,a.o)};u.i0a=function(a){var b=a.o;b&&Flc(this,[b]);Elc(this,a.o)};function Elc(a,b){var c=c7(a.o,a.F,b);if(c){var d=ZA(a.I,c);c0a(a.j,c.hb(),blc(d).length)}else Glc(a)}u.p6a=function(){i7(this);this.k.Vk&&Hlc(this)};u.aZa=function(){i7(this)};
u.YYa=function(a){if(a.o){var b=a.o;this.fT=!0;a=this.q;b=this.H.Mb(b);a.j.highlightDoco(a.k.j[b]||0,void 0);this.fT=!1}else i7(this)};u.ysb=function(){var a=this.k.Bs,b=this.B.isEmpty();this.k.Vk?Hlc(this):a?(Ilc(this,[a]),b&&!this.B.isEmpty()&&(this.fT=!0,b=this.q,a=this.H.Mb(a),b.j.highlightDoco(b.k.j[a]||0,void 0),this.fT=!1)):b||i7(this)};u.xsb=function(){i7(this)};
function i7(a){a.B.clear();var b=a.q;b.j.flushDocoPositions(flc(b,{}));b=a.q;b.j.highlightDoco(b.k.j[""]||0,void 0);R(a.C,!1);N(a.Gt);Jlc(a);Klc(a);a.k.Vk||Llc(a);dlc(a.j,a.k.Vk);Clc(a)}u.isEmpty=function(){return this.B.isEmpty()&&this.X.isEmpty()&&this.K.isEmpty()&&this.M.isEmpty()};function Clc(a){var b=ou(a.A);b&&(a.pda=WEa(b.j)/2,a.q.setOption(Docos.OptionName.MAX_DOCO_HEIGHT,a.pda))}function Klc(a){Hg(a.X.rc());a.X.clear()}function Jlc(a){Hg(a.K.rc());a.K.clear()}
function Llc(a){F(a.M.rc(),function(a){Hm(a,"waffle-docos-target-cell-header")});a.M.clear()}u.ZYa=function(a){this.k.Bs||this.k.Vk||(a=a.docos,a.length?Ilc(this,a):Mlc(this,!1))};function Ilc(a,b){X6(a.q)||Flc(a,od(a.B,b).rc());Dlc(a,b)}function Hlc(a){var b=cB(a.o);b&&(b=ZA(a.I,b),Ilc(a,blc(b)),Nlc(a),Olc(a))}u.wsb=function(a){Plc(this,a.o,a.I)};
function Plc(a,b,c,d){var e=c7(a.o,a.F,b);if(e){var f=e.hb();if(Qlc(a,b)){var h=Rlc(a,c),l=function(){Slc(this,c)&&!h.equals(sv(e))?(zv(e,h),Plc(this,b,c,d)):(iv(e,c).tj()&&WE(ou(this.A)).setVisible(!1),Tlc(this,c),Ilc(this,[b]),Jlc(this),Klc(this),Llc(this),Ulc(this,c),dlc(this.j,this.k.Vk),d&&dh(function(){this.q.j.grabFocus()},0,this),this.dispatchEvent("me"))};cf?jq(tu(xu(a.o,f)),B(e.Ns,e,h)).addCallback(l,a):lq(tu(xu(a.o,f)),B(e.Ns,e,h),B(l,a),new S)}else aw(a.o,f,B(function(){this.q.j.grabFocus();
Plc(this,b,c,!0)},a))}else a.dispatchEvent("me")}function Tlc(a,b){var c=cB(a.o),d=ou(a.A);if(!a.fT&&c&&d){var e=d.j,d=d.k,f=Tx(e,"waffle",!1,!1),h=212;if(!e.tb()){var l=nh("docs-docos-activitybox");l&&ul(l)&&(h+=f.right-sl(l).left)}l=Vlc(a,b);h=l.x-f.right+h;f=l.y-f.bottom+a.pda;if(!(0>=h&&0>=f)){d=d.j.ud();for(d=Mf(d.y,d.x,d.y,d.x);dFa(e,d).height<f;)d.height+=1;for(;dFa(e,d).width<h;)d.width+=1;e=d.height;d=d.width;Av(c,Dla(c,Ala(c,pv(c),d,e)))}}}
function Slc(a,b){var c=cB(a.o);return bv(Ql(c,"r"),b.y)&&bv(Ql(c,"c"),b.x)}function Rlc(a,b){return Xl(cB(a.o),b.y,b.x)||Nf(b)}
u.h0a=function(a){if(!this.k.Vk&&(Jlc(this),Qlc(this,a.o)&&(Mlc(this,!0),this.k.Bs!=a.o))){var b=this.H.Mb(a.o),c=this.q;c.j.isDocoResolved(c.k.j[b]||0)?(b=a.I,a=ou(this.A),(c=cB(this.o))&&a&&b&&(b=Xl(c,b.y,b.x)||Nf(b),b=GSa(a,b,"waffle-docos-target-cell-resolved-rect"),hx(qE(a),b,!0),b.setVisible(!0),this.K.add(b))):(c=a.I,a=ou(this.A),(b=cB(this.o))&&a&&c&&(c=Xl(b,c.y,c.x)||Nf(c),b=new zlc(b,a.H,a.I,a.B,a.j,a.k,new by(c),this.ga),hx(qE(a),b,!0),this.K.add(b),b.setVisible(!0)))}};
function Wlc(a,b){b&&(Fm(b,"waffle-docos-target-cell-header"),a.M.add(b))}function Ulc(a,b){var c=ou(a.A),d=cB(a.o);d&&c&&b&&(d=Xl(d,b.y,b.x)||Nf(b),d=GSa(c,d,"waffle-docos-target-cell-rect"),hx(qE(c),d,!0),a.X.add(d),d.setVisible(!0),d.getElement()&&a.U.D(d.getElement(),["click","contextmenu","dblclick","mousedown","mouseup"],function(a){a.zf=b;c.dispatchEvent(a)}))}function Nlc(a){Klc(a);var b={};F(a.B.rc(),function(a){a=b7(this.F,a);var d=a.x+"-"+a.y;b[d]||(Ulc(this,a),b[d]=!0)},a)}
function Olc(a){Llc(a);var b=cB(a.o),c=ou(a.A);if(b&&c){var d=c.B,c=c.k,b=ZA(a.I,b),e=c.Cf("r"),f=c.ig("r"),h=c.Cf("c"),l=c.ig("c");F(blc(b),function(a){a=b7(this.F,a);a.x>=h&&a.x<=l&&Wlc(this,EDa(d,a.x));a.y>=e&&a.y<=f&&Wlc(this,d.j.getElement(dx(d,"rh-",Ev(d.o,a.y),null)))},a)}}u.P7a=function(){Glc(this)};function Glc(a){var b=qb(dc(a.I.j),Number);F(b,function(a){var b=qlc(this.o,a);b&&(b=ZA(this.I,b),c0a(this.j,a,blc(b).length))},a)}
u.z0a=function(a){if(a.o){var b=this.H.Mb(a.o);a=Vlc(this,a.I);this.q.j.newDoco(b,a)}};
function Dlc(a,b){for(var c={},d=[],e={},f=0;f<b.length;f++){var h=b[f],l=a.H.Mb(h),m;m=a;var n=h;if(ou(m.A)&&Qlc(m,n)){var p=b7(m.F,n);m=Xlc(m,Rlc(m,p))?m.k.Vk||m.k.Bs==n||wb(m.k.j.rc(),n):!1}else m=!1;m?(m=b7(a.F,h),n=m=Rlc(a,m),n=n.ib()+"-"+n.Cb()+"-"+n.gb()+"-"+n.Jb()+"-"+n.j+"-"+n.Rc,e[n]=e[n]||0,c[l]=Vlc(a,m.ud(),e[n]),e[n]++,a.B.add(h)):d.push(h)}a.B.isEmpty()||Mlc(a,!0);gc(c)||(e=a.q,e.j.updateDocoPositions(flc(e,c)));X6(a.q)||Flc(a,d)}
function Flc(a,b){var c=a.B.qp(b).rc();a.B.Db(c);c=qb(c,function(a){return this.H.Mb(a)},a);c.length&&elc(a.q,c);a.B.isEmpty()&&Mlc(a,!1)}
function Vlc(a,b,c){var d=ou(a.A),e=cB(a.o),f=d.j,h=f.tb(),l=Rlc(a,b),m=Ux(f,l),n=c?15*c:0;c=h?m.left-n:m.right+n;var l=m.top+n,p=a.k.Vk;a=yf(a.k.tL,b);var t=iv(e,b).tj();p||a||!t?(b=l+125,0<b-WEa(f)&&(e=e.$m("r")-1,Rx(f,b,"r","waffle")>=e&&(l-=50))):(a=WE(d),p=a.$r,LTa(d,lv(e,b).ud()),e=a.C.height?a.yb:0,b=a.F.height,d=Math.min(xGa.height,e+b),b&&(d=d+30+12,d+=Vy.top,d+=Vy.bottom),e&&(d+=12,d+=Vy.top,d+=Vy.bottom),e=d,Zx(a,p),l+=e);m=h?m.right+n+212:m.left-n-212;n=h?0>c-212:c+212>Ix(f);e=h?m>Ix(f):
0>m;n&&!e&&(c=m);return new Docos.Point(h?Mx(f,c,"c"):c,l)}function Qlc(a,b){var c=c7(a.o,a.F,b),d=cB(a.o);return!!c&&c==d}function Xlc(a,b){if(!b)return!1;var c=glc(ou(a.A)),d=!1,e=b.ud();uda(b,function(a,b){var l;if(l=a==e.y)l=null!=UD(c,new G(b,a));return l?d=!0:!1});return d}u.zsb=function(){Blc(this)};function Blc(a){var b=ou(a.A);b&&(a.ga.appendChild(b.J3,a.C),a.q.setOption(Docos.OptionName.LAYOUT_RTL,b.j.tb()),a.q.setOption(Docos.OptionName.ANCHOR_DIV,a.C),a.q.j.renderAnchorSurface())}
function Mlc(a,b){var c,d=a.C.style;c="";"opacity"in d?c=d.opacity:"MozOpacity"in d?c=d.MozOpacity:"filter"in d&&(d=d.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(c=String(d[1]/100));c=""==c?c:Number(c);c=ta(c)?1:c;ul(a.C)||(c=0);d=b&&1>c?"in":!b&&0<c?"out":"none";"none"==d?(N(a.Gt),R(a.C,b)):a.Gt&&1==a.Gt.ba&&a.d9==d||(N(a.Gt),R(a.C,!0),a.Gt=new Aw(a.C,c,"in"==d?1:0,250),a.d9=d,"out"==d&&Ug(a.Gt,"finish",B(a.l1a,a)),a.Gt.play())}u.l1a=function(){i7(this);var a=ou(this.A);a&&uE(a)};
u.J=function(){delete this.A;delete this.C;delete this.H;delete this.q;delete this.B;delete this.k;delete this.I;delete this.ga;delete this.d9;delete this.F;delete this.o;delete this.Z;N(this.Gt);delete this.Gt;Klc(this);Jlc(this);Llc(this);N(this.U);delete this.U;Alc.G.J.call(this)};function Ylc(a,b,c,d,e,f){L.call(this);this.F=a;this.I=y(b)?b:!0;this.H=y(c)?c:1;this.o=new Rp(B(this.sRa,this),d||1E3,e||6E4,f);M(this,this.o);this.A=new pm(void 0,this);this.j=null;this.B=[];this.q="DCS_Callback"+String(Zlc++);this.C=this.k=null}C(Ylc,L);var Zlc=0;u=Ylc.prototype;u.t8=function(){this.j=null;this.o.stop();this.A.callback(this.B)};
u.Joa=function(a){a instanceof qm||(a instanceof In&&3==a.code?this.t8():(this.j=null,this.B.push(a instanceof Error?a.message:""),0<this.H--?this.o.start():this.A.errback(this.B)))};u.Wcb=function(){this.o.wb()||this.o.start();var a=new pm;um(this.A,a);return a};
u.sRa=function(){if(this.I){this.k=new Rw(this.F);this.k.Cg=1E4;var a=B(this.t8,this);ha(this.q,a,void 0);this.C=this.k.send({callback:this.q},void 0,B(this.Joa,this))}else this.j&&this.j.cancel(),this.j=NFb(this.F,"dcs_main_js",{timeout:1E4}),rm(this.j,this.t8,this.Joa,this)};u.J=function(){this.j&&this.j.cancel();this.A.cancel();fa[this.q]&&(fa[this.q]=ja);this.k&&this.C&&this.k.cancel(this.C);Ylc.G.J.call(this)};function $lc(){return'<div class="docs-docos-activitybox" aria-label="Comment stream box."><div class="docs-docos-activitybox-inner"></div></div>'};function j7(a,b){Wm.call(this,b);this.j=a}C(j7,Wm);u=j7.prototype;u.s8=null;u.aO=null;u.VO=null;u.wm=null;u.Fla=!1;u.Da=function(){j7.G.Da.call(this);var a=this.O(),b=Et($lc,{},{},a);this.Y=b;Kh(b,!0);this.aO=a.getElement("docs-docos-caret");this.s8=Uh(a,"docs-docos-activitybox-inner",b);this.j&&(Fm(b,"docos-enable-new-header"),Fm(this.aO,"docos-enable-new-header"))};
u.aa=function(){this.VO=new Nv(this.getElement());this.VO.Mi("close-box",27);this.wm=new cn(this.getElement(),"toggle_display");dn(this.wm,!0);var a=this.wm;mma(a);a.Bba=!1;this.wm.Gpa=!1;U(this).D(this.VO,"shortcut",this.i9a).D(this.wm,"show",this.nfb).D(this.wm,"hide",this.mfb).D(this.wm,"beforeshow",this.lfb).D(this.wm,"beforehide",this.kfb)};u.kb=g("s8");u.nfb=function(){R(this.aO,!0);this.dispatchEvent("show")};u.mfb=function(){R(this.aO,!1)};u.lfb=function(){return this.dispatchEvent("beforeshow")};
u.kfb=function(){return this.Fla?!1:this.dispatchEvent("hide")};u.setVisible=function(a){this.wm.setVisible(a)};u.Ea=function(){return!!this.wm&&this.wm.Ea()};u.i9a=function(a){switch(a.k){case "close-box":this.setVisible(!1)}};u.J=function(){N(this.VO);delete this.VO;delete this.aO;delete this.s8;N(this.wm);delete this.wm;j7.G.J.call(this)};function amc(a,b,c,d){Q.call(this);this.o=c||new hh;this.j=a;this.B=!!b;this.k=new j7(this.j.isDocsStreamHeaderEnabled&&this.j.isDocsStreamHeaderEnabled(),this.o);this.L=new S(this);this.A=new iD(void 0,void 0,!0,KJ.getInstance());this.q=d||V.Oia;this.j.onReady(B(this.sfb,this))}C(amc,Q);u=amc.prototype;u.Sy=null;u.Ava=!1;u.render=ba();
u.sfb=function(){var a=this.o.getElement("docs-docos-commentsbutton");this.Sy=FV(null);By(this.Sy,16);this.Sy.Ia(a);Qd(Td(),"docosUnreadCommentsEnabled")&&(this.j.setListener(Docos.EventType.UNREAD_COMMENTS,this.Lfb,this),this.j.setOption(Docos.OptionName.ENABLE_UNREAD_COMMENTS,!0),V.Tu.bc(Eq,this.rNa,this));nD(this.A,this.Sy,V.Tu,oD);V.Tu.bc(Eq,this.yjb,this);this.k.render(a.parentNode.parentNode);R(this.k.getElement(),!1);V.Tu.$(!0);this.j.setOption(Docos.OptionName.PANE_DIV,this.k.kb());this.j.setOption(Docos.OptionName.PANE_KB_DIV,
this.k.getElement());this.j.renderPaneSurface();this.j.setListener(Docos.OptionName.DIALOG_OPENED,B(this.Zya,this));this.j.setListener(Docos.OptionName.DIALOG_CLOSED,B(this.Zya,this));this.j.setOption(Docos.OptionName.SORT_PANE,!0);this.j.setOption(Docos.OptionName.STREAM_BUTTON,a);Docos.EventType.CREATE_DRAFT&&(this.j.setListener(Docos.EventType.CREATE_DRAFT,this.XPa,this),this.q.bc(Cq,this.Yya,this),this.Yya(new Bua("enabled",this.q.isEnabled(),!1)));this.B||this.j.setListener(Docos.EventType.NETWORK_ERROR,
this.ifb,this);this.L.D(this.k,["show","hide"],this.meb)};u.Zya=function(a){this.k.Fla=a.type==Docos.OptionName.DIALOG_OPENED};u.Yya=function(a){this.j.setOption(Docos.OptionName.ENABLE_COMMENT_BUTTON,a.newValue)};u.XPa=function(){this.k.setVisible(!1);this.q.fireAction()};u.yjb=function(){var a=this.k;a.wm&&!nma(a.wm)&&a.wm.setVisible(!0)};
function bmc(a,b){if(0>b)throw Error("Number of unread comments cannot be negative");xy(a.Sy,"docs-docos-commentsbutton-unread",0<b);var c=a.o.getElement("docs-docos-commentsbutton");a.o.dg(c,String(b))}u.Lfb=function(){var a=this.j.getUnreadCommentsCount();bmc(this,a)};u.rNa=function(){bmc(this,0);this.j.ackUnreadComments()};
u.ifb=function(){if(!this.Ava&&V.Bi.isEnabled()){if(this.j.hasPendingContent()){var a=kp("Failed to post comment due to a network error.","warning",!0);ip.getInstance().postMessage(a)}this.j.setOption(Docos.OptionName.FATAL_READONLY,!0);this.j.setOption(Docos.OptionName.SHOW_ERRORS,!0);V.Oia.$(!1,"docos-fatal-reason");this.Ava=!0}};u.meb=function(a){a="show"==a.type;this.j.setOption(Docos.OptionName.SORT_PANE,!a);this.Sy.Wb(a);a?this.j.grabFocus():this.dispatchEvent("activity-box-closed")};
u.J=function(){N(this.Sy);delete this.Sy;N(this.L);delete this.L;N(this.k);delete this.k;N(this.A);delete this.A;delete this.j;amc.G.J.call(this)};function cmc(){L.call(this)}C(cmc,Kn);u=cmc.prototype;u.CUa=function(){return Ylc};u.aVa=function(){return amc};u.YUa=function(){return rlc};u.ZUa=function(){return ylc};u.$Ua=function(){return Alc};Sn("docos",cmc);
