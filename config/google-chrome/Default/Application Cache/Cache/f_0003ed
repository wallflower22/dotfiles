function ywc(a,b,c){b=vb(a,b.equals,b);0<=b&&b!=c&&(b=Cb(a,b,1),Cb(a,c,0,b[0]))}function zwc(a){var b=ritz.convertPivotTableDefToRitz(jza.Mb(qza(a))),b=jza.dd((new pj).Q(),b);if(null!=a.B){var c;c=kg(b,6);c=kg(c,1);K(c,6,""+a.B)}return b}function Awc(a,b,c){function d(a){if(a.Zr()){var b=Math.min(e,c),d=Math.max(e,c);a=a.Mr();var m=a.Ir();m==e?a.yn(c):m>=b&&m<=d&&(e>c?a.yn(m+1):e<c&&a.yn(m-1))}}var e=nb(a.q,b);ywc(a.q,b,c);F(a.o,d);F(a.k,d)}
function Bwc(a,b){var c=vb(a.q,b.equals,b);if(0<=c){Fb(a.q,c);var d=function(a){if(a.Zr()){var b=a.Mr(),d=b.Ir();d==c?a.vC():d>c&&b.yn(d-1)}};F(a.o,d);F(a.k,d)}}function Cwc(a,b,c){null!=c?(Bb(a.q,b,c),b=function(a){if(a.Zr()){a=a.Mr();var b=a.Ir();b>=c&&a.yn(b+1)}},F(a.o,b),F(a.k,b)):a.q.push(b)}
function exc(a,b){var c=new ng;K(c,3,a);var d=b.Rc,e=b.isRow(),f=new og;if(!e){var h=new pg,l=b.Jb();K(h,1,l);K(f,2,h)}d||(h=new pg,l=b.Cb(),K(h,1,l),f.sF(h));K(c,2,f);f=new og;e||(e=new pg,h=b.gb()+1,K(e,1,h),K(f,2,e));d||(d=new pg,e=b.ib()+1,K(d,1,e),f.sF(d));K(c,1,f);return c}function fxc(a,b){K(a,2,b)}function gxc(a,b){K(a,3,b)}function hxc(a,b){K(a,8,b)}function ixc(a){return kg(a,8)}function jxc(a,b){K(a,3,b)}
function kxc(a,b,c){var d=b.ib();b=b.gb();a=a?a.Xc(d,b+c).getDisplayValue():"";""==a&&(a="Column "+Js(b+c));return a};function v$(a,b){sF.call(this,1602,b);this.j=a}C(v$,sF);v$.prototype.Ac=function(){return v$.G.Ac.call(this)};v$.prototype.fd=r(47);v$.prototype.cd=function(){var a=new Sr,b=zwc(this.j);K(a,1,b);return a};function w$(a,b){O.call(this,a,b)}C(w$,O);function lxc(a){a=""+Ut(pV(Qt(a,{title:Rt("Report Editor"),ef:St('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+Ut(Ny({yd:"goog-inline-block waffle-pivot-label-button",content:St("Edit range..."),id:"waffle-pivot-range-selection-button",style:4}))+
'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+mxc({Cr:Rt("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+mxc({Cr:Rt("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
mxc({Cr:Rt("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+mxc({Cr:Rt("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return Mt(a)}function mxc(a){var b;b=""+('<strong id="'+Vt(a.id)+'-field-label">'+Y(a.Cr)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=Rt("Add field");b+=Ut(Ny({yd:"goog-inline-block waffle-pivot-label-button",content:c,attributes:Tt('aria-label="'+Vt(a.Cr)+" "+Vt(c)+'"'),id:a.id,style:4}));return Mt(b)}
function nxc(a){return Mt('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+Y(a.VW)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function x$(a,b,c,d,e){Wm.call(this,e);this.F=a;this.I=c;this.H=d;this.be(b)}C(x$,Wm);u=x$.prototype;u.Da=function(){this.Y=Et(nxc,{VW:this.F})};u.aa=function(){x$.G.aa.call(this);var a=this.O(),b=U(this);this.A=Sh(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c=new Py("\u2715",a,4);c.render(Sh(a,"td","waffle-pivot-pill-close",this.getElement())[0]);Cm(c.getElement(),"Close edit field and remove from pivot table");M(this,c);b.D(c,"action",this.Blb)};
u.OF=function(){var a=new w$("pivot-pill-changed",this);a.k=this;this.dispatchEvent(a)};function oxc(a,b){a.O().dg(a.A,b);Cm(a.getElement(),"Edit field: "+(a.F+(" "+(b+"."))));a.A.title=b}function pxc(a){return a.O().eJ(a.A)}function y$(a,b){return kxc(a.I,a.H,b)}function z$(a,b,c){a=a.O();return a.R("span",c,a.createTextNode(b+"\u00a0"))}function A$(a){return a.O().R("div","waffle-pivot-pill-nodrag")}
u.AT=function(a){var b=this.O(),c=b.R("div","waffle-pivot-pill-section",arguments);1<Bh(this.getElement()).length&&Fm(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};u.Fx=function(a){U(this).D(a.getElement(),"mouseover",this.t2).D(a.getElement(),"mouseout",this.t2)};u.t2=function(a){Wla(a.target,"waffle-pivot-select-hover")};u.Ym=g("H");u.Gb=g("I");u.Blb=function(){var a=new w$("pivot-remove-pill",this);a.k=this;this.dispatchEvent(a)};function B$(){}C(B$,JD);ka(B$);B$.prototype.Eb=r("waffle-pivot-select");B$.prototype.GC=function(a){return a.R("div","goog-inline-block "+(this.Eb()+"-dropdown"),"\u00a0\u25be")};function C$(a,b,c,d){x$.call(this,"Filter:",a,b,c,d);this.j=new YF("",null,B$.getInstance(),d);M(this,this.j)}C(C$,x$);C$.prototype.aa=function(){C$.G.aa.call(this);var a=this.getModel();oxc(this,y$(this,a.Xf()));var a=z$(this,"Show:"),b=A$(this);this.j.Ia(b);this.j.as=!0;this.j.qw("Loading...");Cm(this.j.Y,"Show:");var c=new qxc;M(this,c);this.j.De(c);this.Fx(this.j);this.AT(a,b)};function D$(a){return a.j.Ab().j}
C$.prototype.Fx=function(a){C$.G.Fx.call(this,a);U(this).D(D$(this),"filters_selected",this.k).D(D$(this),"filtering_cancelled",this.o)};function rxc(a,b,c){var d=[];if(!c)return d;a=b.gb()+a;var e=Uf(b,"r");for(b=b.ib()+1;b<e.end;b++){var f=c.Xc(b,a);Ub(d,f.getDisplayValue(),yFb)}return d}function sxc(a){var b=D$(a),c=a.getModel().o(),d=new md(c),e=rb(k7(b),function(a,b){return d.contains(b)?a-1:a},k7(b).length);vFb(b,c);txc(a,e)}
function txc(a,b){var c=D$(a);0==b?a.j.qw(zmc()):(c=k7(c).length-b,a.j.qw(zmc(c)))}C$.prototype.k=function(a){this.j.ed(!1);txc(this,a.K.length);this.OF()};C$.prototype.o=function(){this.j.ed(!1);var a=this.j.Y;try{ud&&this.O().pb().body.focus(),a.focus()}catch(b){}sxc(this)};function qxc(a){GD.call(this,a);this.j=new DV([],a)}C(qxc,GD);qxc.prototype.aa=function(){qxc.G.aa.call(this);this.j.render(this.kb());var a=new my(this.j.Y,this.O());ny(a);M(this,a)};function E$(a,b,c,d,e){x$.call(this,"Group by:",a,b,c,e);this.K=d}C(E$,x$);u=E$.prototype;
u.aa=function(){E$.G.aa.call(this);var a=this.getModel();oxc(this,y$(this,a.Xf()));var b=this.O(),a=z$(this,"Order:"),c=A$(this),d=new GD;d.ua(new BD(b.yg("Ascending"),1),!0);d.ua(new BD(b.yg("Descending"),2),!0);b=this.B=new YF("",d,B$.getInstance(),b);b.Ia(c);b.Ca(ixc(this.getModel()));Cm(b.getElement(),"Order:");this.Fx(b);this.AT(a,c);var b=this.O(),c=z$(this,"Sort by:"),a=A$(this),d=new GD,e=y$(this,this.getModel().Xf());d.ua(new BD(e,-1),!0);d=this.o=new YF("",d,B$.getInstance(),b);d.Ia(a);
Cm(d.getElement(),"Sort by:");U(this).D(d.getElement(),"mouseover",this.t2).D(d.getElement(),"mouseout",this.t2).D(d,"action",this.Flb);b=B(b.R,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.C=b(a);this.AT(c,this.C);a=this.getModel();a=kg(a,3);c=z$(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=A$(this);Fm(b,"goog-inline-block");this.k=new ZI;XI(this.k,c);this.k.Wb(a);this.k.render(b);U(this).D(this.k,"change",this.OF);this.AT(b,c)};
u.isRow=g("K");u.Flb=function(a){a=new w$("pivot-sort-by-change",a.currentTarget);a.k=this;this.dispatchEvent(a)};u.Glb=function(a){a=new w$("pivot-sort-key-change",a.currentTarget);a.k=this;this.dispatchEvent(a)};function uxc(a){var b=[];if(a.j)for(var c=a.j.Ob(),d=0;d<c;d++)0<=a.j.Zb(d).V()&&b.push(a.j.Zb(d).hg());return b}function vxc(a){if(!a.j){var b=a.O(),c=A$(a);Fm(c,"waffle-pivot-multi-select");a.j=new sD("horizontal",null,b);a.j.Ia(c);b.appendChild(a.C,c)}}
u.Fx=function(a){E$.G.Fx.call(this,a);U(this).D(a,"hide",this.OF)};u.J=function(){E$.G.J.call(this);N(this.B);N(this.o);N(this.j);N(this.k);this.C=null};function F$(a,b,c,d){x$.call(this,"Display:",a,b,c,d)}C(F$,x$);var wxc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" ");F$.prototype.aa=function(){F$.G.aa.call(this);var a=this.getModel();oxc(this,y$(this,a.Xf()));xxc(this)};
function xxc(a){var b=a.O(),c=z$(a,"Summarize by:"),d=A$(a),e=new GD;F(wxc,function(a){e.ua(new BD(a),!0)});b=a.j=new YF("",e,B$.getInstance(),b);b.Ia(d);b.Ca(a.getModel().Rt());Cm(b.getElement(),"Summarize by:");a.Fx(b);a.AT(c,d)}F$.prototype.V=function(){return this.j.V()};F$.prototype.Fx=function(a){F$.G.Fx.call(this,a);U(this).D(a,"hide",this.OF)};F$.prototype.J=function(){F$.G.J.call(this);N(this.j)};function G$(a,b,c,d,e){qV.call(this,e);this.Qa=b;this.eb=c;this.Z=d;this.j={};this.A=!0;this.U=new yxc;this.K=new S(this);this.M=new fW;this.I=[];this.B=this.o=null;this.Wa=new BD("No fields left to add",void 0,e);this.Wa.$(!1)}C(G$,qV);
var H$={pv:"waffle-pivot-values",Us:"waffle-pivot-filter",T3:"waffle-pivot-column-label",m5:"waffle-pivot-row-label",A3:"waffle-pivot-add-field-value",y3:"waffle-pivot-add-field-filter",z3:"waffle-pivot-add-field-row",x3:"waffle-pivot-add-field-column",B3:"waffle-pivot-aggr-select",C3:"waffle-pivot-aggr",yGa:"waffle-pivot-apply",Q3:"waffle-pivot-button-container",MKa:"waffle-pivot-range-selection",NKa:"waffle-pivot-range-selection-button",OKa:"waffle-pivot-range-text",nN:"waffle-pivot-button-update",
G5:"waffle-pivot-update-auto",H5:"waffle-pivot-update-manual"},I$={hN:"row-breakout",wM:"col-breakout",Us:"filter",pv:"aggregation"};u=G$.prototype;u.JT=null;u.Da=function(){var a=this.O();this.Y=Et(lxc,{id:this.getId()});var b=new GD(a);b.ua(new BD("Columns",2,a),!0);b.ua(new BD("Rows",1,a),!0);this.C=new YF("",b,B$.getInstance(),a)};
u.aa=function(){function a(a,b){e.D(kh(a),"click",b)}G$.G.aa.call(this);var b=this.O();R(b.getElement(H$.Q3),!1);this.F=pc(I$.pv,b.getElement(H$.pv),I$.Us,b.getElement(H$.Us),I$.hN,b.getElement(H$.m5),I$.wM,b.getElement(H$.T3));this.xa=pc(H$.A3,I$.pv,H$.y3,I$.Us,H$.z3,I$.hN,H$.x3,I$.wM);this.jb=b.getElement(H$.nN);var c=ry(vM,""),d=vmc(),e=U(this),f;for(f in this.xa){var h=new KD("",new GD(b,d),c,b);M(this,h);h.Ia(b.getElement(f));e.D(h,"show",this.Lob).D(h.Ab(),"action",this.Kob)}a(H$.nN,this.Vob);
a(H$.G5,this.oEa);a(H$.H5,this.oEa);this.H=b.getElement(H$.C3);R(this.H,!1);this.C.Ia(b.getElement(H$.B3));e.D(this.C,"action",this.Mob);this.B||(this.B=new Tm(this.kb()));e.D(this.B,"focusin",this.Qob).D(this.B,"focusout",this.Rob);zxc(this)};u.Qob=function(a){this.o=Axc(this,a.target)};u.Rob=function(a){if(a=a.relatedTarget){var b=this.kb();Nh(a,function(a){return a==b})||(this.o=null)}};
function Axc(a,b){if(!b)return null;var c=a.O().Bqa(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;ac(a.j,function(a,b){return(d=ub(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:pxc(d)}:null}
function Bxc(a){var b=a.O();if(a.o){var c=a.o.container,d=a.j[c];if(d&&a.o.label)for(var e=0,f;f=d[e];e++)if(pxc(f)==a.o.label){J$(a,f.getElement());return}d&&0<d.length?J$(a,d[d.length-1].getElement()):(d=fc(a.xa,function(a){return a==c}),J$(a,b.getElement(d)))}}
u.be=function(a){G$.G.be.call(this,a);Cxc(this,function(){function b(a,b){var c="row-breakout"==a,c=new E$(b,K$(this),L$(this),c,this.O());c.render();Dxc(this,c,a)}this.reset();F(a.Qt(),function(a){a=new C$(a,K$(this),L$(this),this.O());a.render();Dxc(this,a,"filter")},this);F(a.co(),Aa(b,"row-breakout"),this);F(a.$n(),Aa(b,"col-breakout"),this);F(a.Lt(),function(a){a=new F$(a,K$(this),L$(this),this.O());a.render();Dxc(this,a,"aggregation")},this);var c;c=(c=(c=xu(this.Z.j,a.Tt()))?c.k:null)?Vs(a.Ym(K$(this)),
c):"#REF!";Exc(this,c);this.U.Ca(c);(c=this.j.aggregation)&&2<=c.length?(R(this.H,!0),this.C.Ca(a.Vo())):R(this.H,!1);Bxc(this)});Fxc(this,function(){var a=this.j.filter;a&&F(a,function(a){var b=D$(a),e;e=rxc(a.getModel().Xf(),a.Ym(),a.Gb());uFb(b,e);sxc(a)},this)})};u.focus=function(){G$.G.focus.call(this);J$(this,nh("waffle-sidebar-title",this.getElement()))};function Dxc(a,b,c){a.F[c].appendChild(b.getElement());a.j[c]||(a.j[c]=[]);a.j[c].push(b);b.dc(a);Gxc(a,b);zxc(a)}
function Gxc(a,b){U(a).D(b,"pivot-remove-pill",a.Uob).D(b,"pivot-pill-changed",a.Tob).D(b.getElement(),"keydown",a.Sob);var c=new w$("pivot-pill-created");c.k=b;a.dispatchEvent(c)}function zxc(a){a.K.Db();N(a.M);var b=a.M=new fW;Yb(a.F,function(a){DGb(b,a)});b.vd();a.K.D(b,"beforedragstart",a.Nob).D(b,"dragstart",a.Pob).D(b,"dragend",a.Oob)}u.reset=function(){Yb(this.j,function(a){F(a,N)});this.j={}};function Exc(a,b){var c=a.O();c.dg(c.getElement("waffle-pivot-range-text"),b)}
u.Uob=function(a){var b=new w$("pivot-pill-removed",this);b.k=a.target;b.container=fc(this.j,function(b){return wb(b,a.target)});b.container&&(Eb(this.j[b.container],a.target),this.o={container:b.container,label:null},this.dispatchEvent(b))};u.Tob=function(a){a.container=fc(this.j,function(b){return wb(b,a.target)})};u.Sob=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||Hxc(this,a.target,38==a.keyCode)};
function Hxc(a,b,c){var d=null,e=-1;ac(a.F,function(a,c){e=nb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.j[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){Bmc(f,e,c);var h=new w$("pivot-pill-changed",a);h.k=f[c];h.container=d;h.B=d;h.position=c;a.dispatchEvent(h)}}u.Vob=function(){this.dispatchEvent("pivot-table-update")};u.oEa=function(a){a=this.A="autoupdate"==a.target.value;(this.jb.disabled=a)&&this.dispatchEvent("pivot-table-update")};u.Mob=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};
u.Vo=function(){return this.C.V()};function Ixc(a,b,c,d){var e=a.U;Wg(a.JT);lFb(a.Qa,e,e.V(),!1,!1,!0,B(a.Wob,a,b,c,!!d))}u.Wob=function(a,b,c,d){var e=this.U,f=this.Z;e.j=!1;var h=e.V();this.JT=Ug(d,"afterhide",function(){if(e.j){var d=Ss(e.V(),f.j,!0,!0);d?a(d):(e.Ca(h),b())}else b();c||J$(this,kh("waffle-pivot-range-selection-button"))},!1,this)};
u.Lob=function(a){var b=a.target.getParent(),c=b.Ab();this.Ua=this.xa[b.Y.id];Cxc(this,function(){var a=this.Ua,e=K$(this),f=L$(this),a=Jxc(this,a);c.kd(!0);for(var h=Uf(f,"c"),l=0,m=h.start;m<h.end;m++){var n=kxc(e,f,l);n&&!a[n]&&c.ua(new BD(n,l),!0);l++}0==c.Ob()&&c.ua(this.Wa,!0);SS(b,!0);b.wu();SS(b,!1)})};function J$(a,b){try{ud&&a.O().pb().body.focus(),b.focus(),a.eb.j(2)}catch(c){}}
u.Kob=function(a){var b=this.Ua;a=a.target.V();var c=new w$("pivot-pill-added",this);c.container=b;c.M=a;this.o={container:b,label:null};this.dispatchEvent(c)};u.Nob=function(a){for(var b=a.event.target||a.event.k.target;b instanceof Element&&!Em(b,"waffle-pivot-pill");b=b.parentNode)if(Em(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};u.Pob=function(a){var b=yl(a.k).width;ol(a.B,b)};
u.Oob=function(a){var b,c,d,e,f=new w$("pivot-pill-changed",this);ac(this.F,function(c,d){e=nb(c.childNodes,a.k);return 0<=e?(b=d,!0):!1});ac(this.j,function(b,e){var m=ub(b,function(b){return b.getElement()==a.k});return m?(c=e,f.k=d=m,!0):!1});this.j[b]||(this.j[b]=[]);Eb(this.j[c],d);Bb(this.j[b],d,e);f.container=b;f.B=c;f.position=e;this.dispatchEvent(f)};
function Jxc(a,b){function c(a){a=f(a.Xf());e[a]=!0}var d=a.getModel(),e={},f=B(kxc,a,K$(a),L$(a));if(d)switch(b){case "filter":F(d.Qt(),c);break;case "row-breakout":case "col-breakout":F(d.co(),c),F(d.$n(),c)}return e}function Cxc(a,b){var c=Kxc(a);if(c){var d=L$(a),d=new Lf(d.ib(),d.gb(),d.ib()+1,d.Jb());cf?Lxc(a,d,b):kq(c.Hf,d,B(b,a),U(a))}else b.call(a)}function Fxc(a,b){var c=Kxc(a);c?cf?Lxc(a,L$(a),b):kq(c.Hf,L$(a),B(b,a),U(a)):b.call(a)}
function Lxc(a,b,c){b=iq(tu(Kxc(a)),b).addCallback(c,a);a.I.push(b);tm(b,Aa(Eb,a.I,b))}function Kxc(a){var b=a.getModel();return xu(a.Z.j,b.Tt())}function K$(a){return(a=Kxc(a))?a.Gb():null}function L$(a){return a.getModel().Ym(K$(a))}u.J=function(){G$.G.J.call(this);Yb(this.j,function(a){F(a,N)});this.j={};Wg(this.JT);this.JT=null;N(this.M);N(this.K);F(this.I,iw)};function yxc(){Q.call(this);this.k="";this.j=!1}C(yxc,Q);yxc.prototype.V=g("k");yxc.prototype.Ca=function(a){this.k=a;this.j=!0;this.dispatchEvent("change")};function M$(a,b){L.call(this);this.j=a;this.o=b;this.k=new S(this);M(this,this.k);this.k.D(a,"pivot-pill-created",this.q)}C(M$,L);M$.prototype.A=function(a){var b=a.k;-1==a.target.V()?(b.j&&(N(b.j),b.j=null),b.OF()):0<Mxc(this,b).length&&!b.j?(vxc(b),b.j.getElement().focus(),Nxc(this,b,-2,!0)):b.OF()};
M$.prototype.B=function(a){var b=a.k;a=a.target;var c=bn(b.j,a),d=b.O();for(c++;c<b.j.Ob();){var e=b.j.Zb(c),f=d.Bra(e.getElement());Em(f,"waffle-pivot-select-divider")&&d.xf(f);b.j.removeChild(e,!0)}(0>a.V()||!Nxc(this,b,-2,!0))&&b.OF()};function Oxc(a,b){a.k.D(b,"pivot-sort-by-change",a.A).D(b,"pivot-sort-key-change",a.B)}
M$.prototype.q=function(a){var b=a.k;if(b instanceof E$){var c=0<Mxc(this,b).length;a=this.j.getModel().Lt();F(a,function(a,d){var h=a.getFunctionName(),l=y$(b,a.Xf());b.o.pd(new BD(c?h+(" of "+(l+" in...")):h+(" of "+l),d))});a=b.getModel();if(a.Zr()){var d=a.Mr();a=d.ZS();Pxc(this,b,a)&&(d=d.Ir(),b.o.Ca(d),c&&(vxc(b),F(a,B(function(a){Nxc(this,b,a,!1)},this)),Nxc(this,b,-1,!1)))}Oxc(this,b)}};
function Nxc(a,b,c,d){var e=Qxc(a,b);if(0==e.length)return!1;var f=b.j.Ob();a=Mxc(a,b);if(f>=a.length)return!1;var h=y$(b,a[f].Xf()),f=b.O();a=b.j.Ob();var l=new GD,m=new BD(h,-2);m.$(!1);l.ua(m,!0);l.ua(new BD(0==a?"Grand Total":"Total",-1),!0);for(m=0;m<e.length;m++)l.ua(new BD(e[m],m),!0);h=new YF(h,l,B$.getInstance(),f);h.Ca(-2);b.j.ua(h,!0);0<a&&(a=f.R("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.fu(a,h.getElement()));U(b).D(h,"action",b.Glb);f=c;"string"==typeof c&&(f=nb(e,
c),-1==f&&(f=-2));h.Ca(f);d&&(b.j.Xe(h),h.ed(!0));return!0}function Qxc(a,b){var c=Rxc(a,b),d=uxc(b),e=d.length,f=[];F(c,function(a){a.length==e+1&&tb(d,function(b,c){return a[c]==b})&&Ub(f,a[e])});return f}function Pxc(a,b,c){a=Rxc(a,b);return 0==c.length||sb(a,function(a){return Sb(c,a)})}function Mxc(a,b){return b.isRow()?a.j.getModel().$n():a.j.getModel().co()}function Rxc(a,b){return b.isRow()?kza(a.j.getModel(),a.o):lza(a.j.getModel(),a.o)};function N$(a,b){Xs.call(this,1601,b,Nf(yu(a,b)));this.j=a}C(N$,Xs);N$.prototype.exec=function(){var a=yu(this.j,this.getModel()),b=this.getModel();DAa(b.j,a.y,"r")&&(a=this.getModel().W9(),b=this.j,(a.Na=b)||a.Z?Ol(a,1024):a.j&=-1025)};N$.prototype.Ac=function(){return N$.G.Ac.call(this)};N$.prototype.fd=r(48);N$.prototype.cd=function(){var a=new Tr,b=zwc(this.j);K(a,2,b);var b=yu(this.j,this.getModel()),c=new di;K(c,1,""+this.j.km());c.Es(b.y);K(c,3,b.x);K(a,1,c);return a};function Sxc(a,b,c,d,e){oV.call(this,a,c);this.j=a;this.k=b;this.F=d;this.B=e;this.H=new M$(this.j,this.k);M(this,this.H);b=b.j;c=a.O();this.L.D(a,"pivot-table-update",this.Fob).D(a,"pivot-pill-added",this.xob).D(a,"pivot-pill-removed",this.zob).D(a,"pivot-pill-changed",this.yob).D(a,"pivot-aggregation-orientation-changed",this.wob).D(Vn,"show-pivot",this.Eob).D(e,"activeCellChange",this.kha).D(e,"click",this.Gob,!0).D(e,"pivot_table_zippy_toggle",this.Hob).D(b,"a",this.kha).D(b,"d",this.Dob).D(c.getElement("waffle-pivot-range-selection-button"),
"click",this.Aob).D(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.Bob);a=["Xa"];a.push("ha");this.L.D(Cu(b),a,this.kha)}C(Sxc,oV);u=Sxc.prototype;u.D2=null;u.uB=null;u.Wg=function(){return X.d5};u.pq=function(){return X.c5};u.Aob=function(){Txc(this)};u.Bob=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),Txc(this))};function Txc(a){Ixc(a.j,B(a.Cob,a,O$(a)),ja)}
u.Cob=function(a,b){a.B=b.cc;var c=exc(b.Pf,b.rect);a.C=c;P$(this,a,this.j.A);var c=a.km(),d=this.k.j;ss(d)!=c&&aw(d,c)};u.Eob=function(){if(!xf(Se.getInstance())){var a=this.j;if(!a.Ea()){var b=this.k.j.getActiveGrid(),c=Q$(this);if(!c&&b){this.j.reset();var a=b.Hf,c=b.Gb(),d=uv(c),e=sv(c);d?(cf?mq(a,e,cc(Fd)):oq(a,e,cc(Fd),this.L)).addCallback(B(this.nEa,this,b)):this.nEa(b,mv(c));return}this.uB=c;a.be(c)}this.pq().fireAction()}};
u.yob=function(a){var b=a.container,c=a.B,d=a.k,e=a.k.getModel(),f=d;if(d&&c&&b!=c){f=Uxc(d.getModel(),b);t:{var h=this.j;switch(b){case "row-breakout":case "col-breakout":var l="row-breakout"==b,f=new E$(f,K$(h),L$(h),l,h.O());break t;case "aggregation":f=new F$(f,K$(h),L$(h),h.O());break t;case "filter":f=new C$(f,K$(h),L$(h),h.O());break t;default:f=null}}f.render();h=this.j;l=f;h.O().QA(l.getElement(),d.getElement());var m=h.j[b],n=nb(m,d);Cb(m,n,1,l);N(d);l.dc(h);Gxc(h,l);zxc(h)}d=O$(this);a=
a.position;h=c==b;l=f.getModel().Xf();if(c)if(h){f=f.getModel();switch(b){case "row-breakout":ywc(d.o,f,a);break;case "col-breakout":ywc(d.k,f,a);break;case "filter":ywc(d.A,f,a);break;case "aggregation":Awc(d,f,a)}Yn(ymc(a))}else Vxc(this,b,d,l,a);else Wxc(b,f,d);c&&!h&&Xxc(e,c,d);P$(this,d,this.j.A)};
function Uxc(a,b){switch(b){case "row-breakout":case "col-breakout":if(a instanceof rg)return a;var c=new rg,d=a.Xf();K(c,9,d);return c;case "aggregation":if(a instanceof tg)return a;c=new tg;d=a.Xf();K(c,3,d);return c;case "filter":if(a instanceof mg)return a;c=new mg;d=a.Xf();K(c,6,d);return c;default:return null}}u.xob=function(a){var b=a.container,c=O$(this);Vxc(this,b,c,a.M,a.position);P$(this,c,this.j.A)};u.zob=function(a){var b=O$(this);Xxc(a.k.getModel(),a.container,b);N(a.k);P$(this,b,this.j.A)};
u.wob=function(){var a=O$(this),b=this.j.Vo();a.F=b;P$(this,a,this.j.A)};function Vxc(a,b,c,d,e){switch(b){case "row-breakout":a=new rg;K(a,9,d);d=a;null!=e?Bb(c.o,d,e):c.o.push(d);break;case "col-breakout":a=new rg;K(a,9,d);d=a;null!=e?Bb(c.k,d,e):c.k.push(d);break;case "filter":a=xu(a.k.j,c.Tt()).Gb();a=rxc(d,c.Ym(a),a);b=new mg;K(b,6,d);Yxc(b,a);null!=e?Bb(c.A,b,e):c.A.push(b);break;case "aggregation":a=new tg,K(a,3,d),fxc(a,"SUM"),Cwc(c,a,e)}}
function Xxc(a,b,c){switch(b){case "row-breakout":Hb(c.o,a.equals,a);break;case "col-breakout":Hb(c.k,a.equals,a);break;case "filter":Hb(c.A,a.equals,a);break;case "aggregation":Bwc(c,a)}}
function Wxc(a,b,c){if("aggregation"==a)a=ub(c.Lt(),function(a){return a.equals(b.getModel())}),null!=a&&fxc(a,b.V());else if("filter"==a)a=ub(c.Qt(),function(a){return a.equals(b.getModel())}),null!=a&&Yxc(a,wFb(D$(b),!0));else if(a=ub("row-breakout"==a?c.co():c.$n(),function(a){return a.equals(b.getModel())}),null!=a)if(jxc(a,b.k.mc()),hxc(a,b.B.V()),-1!=b.o.V()){var d=new sg;d.yn(b.o.V());F(uxc(b),function(a){gg(d,2,a)});gxc(d,b.B.V());K(a,10,d)}else a.vC()}u.Fob=function(){P$(this,Q$(this),!0)};
function P$(a,b,c){b&&(c?(c=ms(a.k.j,b.km()),c=new N$(b,c),a.F.Ib(c),a.D2=null):a.D2=b,a.j.be(b))}u.nEa=function(a,b){var c=a.Gb(),d=uv(c),c=sv(c);d&&b.equals(c)?Ixc(this.j,B(this.mEa,this),B(this.Iob,this),!0):this.mEa(new qo(a.Va(),a.k,b))};u.Iob=function(){this.Wg().setVisible(!1);this.C.j(3)};
u.mEa=function(a){var b;b=new ug;var c=new ng,d=new og,e=new pg,f=new pg;K(e,1,1);K(f,1,1);d.sF(e);K(d,2,f);var e=new og,f=new pg,h=new pg;K(f,1,1);K(h,1,1);e.sF(f);K(e,2,h);K(c,1,d);K(c,2,e);K(b,6,c);K(b,5,2);b=pza(b,0,new G(0,0),0);b.B=a.cc;a=exc(a.Pf,a.rect);b.C=a;a=ss(this.k.j);this.F.Ib(new v$(b,a))};function Q$(a){return a.D2?a.D2:(a=a.k.j.getActiveSheet())&&0==a.getSheetType()?zBa(a.Gb()):null}function O$(a){return(a=Q$(a))?a.clone():null}
u.kha=function(a){var b=Q$(this);if(("Xa"==a.type||"ha"==a.type)&&!b&&this.uB&&(a=this.k.j.getActiveGrid())&&(a=a.Gb(),a.hb()==this.uB.km())){var c=yu(this.uB,a);c&&(vv(a,c),b=Q$(this))}b&&!b.equals(this.uB,this.k)&&this.j.be(b);this.uB=b;this.Wg().setVisible(!!b&&!vE(this.k))};u.Dob=function(a){a=a.target;if(this.uB&&this.uB.km()==a.Va()&&this.j.Ea()){a=this.j;var b=Nya(a.Qa);b&&a.JT&&b.setVisible(!1)}};
u.Gob=function(a){var b=a.target;if(Em(b,wmc.Qka)||Em(b,wmc.Pka)){var b=ou(this.B).getModel(),c=iv(b,a.zf);Zxc(this,b,c);a.stopPropagation()}};u.Hob=function(a){var b=ou(this.B).getModel();a=iv(b,a.zf);Zxc(this,b,a)};
function Zxc(a,b,c){if(!vE(a.k)){var d=c.Rj();b=ABa(b,c);if(c=d.JP()){var e=c.length-1;c=c[e];for(var d="r"==d.sD()?b.co()[e]:b.$n()[e],e=jg(d,7),f,h=0;h<e.length;h++)if(e[h].V()==c){f=e[h];var l=!I(f,3);K(f,3,l)}f||(f=new qg,f.Ca(c),K(f,3,!0),gg(d,7,f));Yn(I(f,3)?"Pivot table field collapsed":"Pivot table field expanded");P$(a,b,!0)}}}function Yxc(a,b){hg(a,3);K(a,5,!1);F(b,function(b){gg(a,3,b)})}u.J=function(){Sxc.G.J.call(this)};function $xc(){L.call(this)}C($xc,Kn);$xc.prototype.k=function(){return G$};$xc.prototype.j=function(){return Sxc};Sn("pivottables",$xc);
