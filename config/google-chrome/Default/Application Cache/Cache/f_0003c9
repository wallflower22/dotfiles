zj.prototype.EP=Z(56,function(a){return I(this,2,a)});function fLb(a,b){var c=new LV,d;for(d in a.j)d in b.j||(c.j[d]=null);return c}function gLb(a){return""+eGb(Qt(a,{l8:"docs-icon-close-small"}))}
function hLb(a){return"<div"+(a.id?' id="'+Y(a.id)+'"':"")+' class="'+(a.xe?Y(a.xe)+" ":"")+'goog-flat-menu-button goog-flat-menu-button-disabled goog-inline-block" role="button" '+(a.Lo?'aria-label="'+Y(a.Lo)+'"':"")+'><div class="goog-flat-menu-button-caption goog-inline-block">'+$t(a.ir)+'</div><div class="goog-flat-menu-button-dropdown goog-inline-block" aria-hidden="true">&nbsp;</div>'+(a.pi?$t(a.pi):"")+"</div>"}function iLb(){this.WX=this.xm=null}
iLb.prototype.Oa=function(){return new iD(this.xm||void 0,void 0,!0,this.WX||KJ.getInstance())};function jLb(a,b){OI.call(this);this.ba=a;this.j[a]=b}C(jLb,OI);jLb.prototype.k=function(a){var b={};b[this.ba]=a;PI(this,b)};function zX(){sL.call(this);this.j=new LV;uL(this,new rL(tL,{},{wordList:[]}))}C(zX,sL);ka(zX);zX.prototype.k=function(a){kLb(this,a,!0)};function kLb(a,b,c){var d=a.j.contains(b.toLowerCase()),e=b.toLowerCase();a.j.add(e);if(!d){var f={};f.value=e;vL(a).get("wordList").push(f);c&&lLb(a,[b],[])}return!d}zX.prototype.q=function(a){mLb(this,a,!0)};
function mLb(a,b,c){var d=a.j.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.j.remove(e);for(var f=vL(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&lLb(a,[],[b])}return d}zX.prototype.o=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)kLb(this,a[b].value,!1);a.length&&this.dispatchEvent("userDictionaryChange")};
function lLb(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.dispatchEvent("userDictionaryChange");a.dispatchEvent(new xL(a,new wL("docs-user_dictionary",d),vL(a)))};function AX(a,b,c){tt.call(this,a,b,c);gn(this,"Preferences")}C(AX,tt);u=AX.prototype;u.aa=function(){AX.G.aa.call(this);U(this).D(this,"dialogselect",this.ZQa)};u.setVisible=function(a){AX.G.setVisible.call(this,a);a&&this.update()};u.update=ja;u.ZQa=function(a){"ok"==a.key&&this.rBa()};u.rBa=ja;function nLb(a){return a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input jfk-textinput" type="text" aria-label="'+Y(a.wwa)+'" placeholder="'+Y(a.wwa)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+Oy({yd:"docs-userdictionarydialog-button-add",style:0,ef:"Add"})+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>')};function oLb(a){return'<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+Y(a.oM)+'" class="docs-userdictionarydialog-row-content">'+Y(a.oM)+"</div></div>"};function BX(a,b){vy.call(this,void 0,new pLb);this.pia=a;this.j=b}C(BX,vy);BX.prototype.gp=ba();BX.prototype.oJ=function(a){a.relatedTarget&&Gh(this.j,a.relatedTarget)||BX.G.oJ.call(this,a)};BX.prototype.ej=function(a){return(46==a.keyCode||8==a.keyCode)&&this.wi(a)};function pLb(){}C(pLb,qy);pLb.prototype.Eb=r("docs-userdictionarydialog-row-container");pLb.prototype.wg=function(a){return Et(oLb,{oM:a.pia})};function CX(a){sD.call(this,void 0,new qLb);this.k=a;this.j=this.o=null}C(CX,sD);u=CX.prototype;u.aa=function(){CX.G.aa.call(this);Cm(this.Y,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");xm(this.Y,"listbox");var a=this.o;R(a,!1);wl(a,!0);this.j=new cu(a);U(this).D(this,"action",this.tea).D(this.o,"click",this.tea).D(this.j,"key",this.JYa)};u.Vc=function(){CX.G.Vc.call(this);N(this.j);this.j=null};
function rLb(a){var b=[];a.hf(function(a){b.push(a.pia)});return b}u.tea=function(){var a;a=vD(this);var b=this.oq()==this.Ob()-1;xD(this);this.removeChild(a,!0);b||yD(this);sLb(this);this.dispatchEvent("change")};u.JYa=function(a){return 13==a.keyCode||32==a.keyCode?(this.tea(),a.preventDefault(),a.stopPropagation(),!0):!1};u.QD=function(){0==Ym(this,"docs-userdictionarydialog-row-container-hover").length&&wD(this)};u.kw=function(a){a.stopPropagation();a.preventDefault()};
u.Rh=function(a){return 27==a.keyCode?!1:CX.G.Rh.call(this,a)};u.eQ=function(a){CX.G.eQ.call(this,a);sLb(this)};u.H$=function(a){var b=Qh(document);CX.G.H$.call(this,a);b&&Em(b,"docs-userdictionarydialog-list-remove-button")?this.Y.focus():sLb(this)};function sLb(a){if(vD(a)){var b;b=vD(a);var c=Math.round((rl(b.Y).height-rl(a.o).height)/2);a.o.style.top=fl(b.Y).y+c+"px";Cm(a.o,"Remove "+b.pia);R(a.o,!0)}else R(a.o,!1)}function qLb(){this.j=void 0}C(qLb,rD);
qLb.prototype.np=function(a){var b=Et(gLb,{enabled:!0,xe:"docs-userdictionarydialog-list-remove-button"});a.o=b;a.getElement().appendChild(b)};function DX(a,b,c,d){AX.call(this,b,c,d);this.F=a;this.o=new Py(null,d);this.ua(this.o);this.Yb=this.j=null;this.B=new CX(a);this.ua(this.B);this.C=null;gn(this,"Personal dictionary");a=tn((new nn).set("ok","Save",!0),vn,!1,!0);qn(this,a)}C(DX,AX);u=DX.prototype;u.Da=function(){DX.G.Da.call(this);Ct(this.kb(),nLb,{wwa:"Add a new word"});AG(this,"ok");this.o.Ia(Zm(this,"docs-userdictionarydialog-button-add"));this.B.Ia(Zm(this,"docs-userdictionarydialog-list-container"));this.j=Zm(this,"docs-userdictionarydialog-input")};
u.aa=function(){DX.G.aa.call(this);this.o.$(!1);this.Yb=new oy(this.j);U(this).D(this.o,"action",this.UXa).D(this.j,"keypress",this.WSa).D(this.Yb,"input",this.VSa).D(this.B,"change",this.X_a);U(this).D(this.o.getElement(),"focus",this.J8).D(this.j,"focus",this.J8);for(var a=this.k.Y.getElementsByTagName("BUTTON"),b=0;b<a.length;b++)U(this).D(a[b],"focus",this.J8);this.C=new vI(this.B)};u.Vc=function(){DX.G.Vc.call(this);Hg(this.Yb,this.C);this.C=this.Yb=null};u.UXa=function(){tLb(this)};u.VSa=function(){this.o.$(!Qa(db(this.j.value)))};
u.WSa=function(a){13==a.keyCode&&(this.o.isEnabled()&&tLb(this),a.stopPropagation(),a.preventDefault())};u.J8=function(){this.B.Li(-1)};u.X_a=function(){sn(this.k,"ok").disabled=!1};u.update=function(){var a=this.B;a.kd(!0);var b=a.k.j.rc();b.sort(uGb());for(var c=0;c<b.length;c++)a.ua(new BX(b[c],a.o),!0);uLb(this,"");sn(this.k,"ok").disabled=!0};
u.rBa=function(){var a,b;a=this.B;b=new LV(a.k.j.rc());var c=new LV(rLb(a));a=fLb(c,b).rc();b=fLb(b,c).rc();for(var c=this.F,d=[],e=[],f=0;f<a.length;f++)kLb(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)mLb(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&lLb(c,d,e)};u.setVisible=function(a){DX.G.setVisible.call(this,a);if(a){var b=this.j;b&&(b.focus(),a=b.value.length,UCa(b)?(b.selectionStart=a,b.selectionEnd=a):ud&&(a=WCa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};
function uLb(a,b,c){a.j.value=b;a.o.$(!Qa(db(a.j.value)));c&&a.j.select()}function tLb(a){var b=a.B,c=a.j.value,c=c.toLowerCase().trim();-1==rLb(b).indexOf(c)&&(c=new BX(c,b.o),b.fk(c,0,!0),b.Y.scrollTop=0,b.dispatchEvent("change"));VS(a.O())==a.j&&a.j.blur();uLb(a,"");a.j.focus()};function vLb(a,b){var c=new DX(zX.getInstance());a.ei(c);return Aa(wLb,c,b)}function wLb(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&uLb(a,c,!0)};function xLb(){Q.call(this);this.j=new md}C(xLb,Q);function yLb(a,b,c,d,e,f,h,l){this.j=a;this.C=b instanceof Element?Ic(b):b;this.F=c;this.H=d;this.k=e;this.o=f;this.q=h;this.A=l||null;this.L=new S(this);M(this,this.L)}C(yLb,L);u=yLb.prototype;u.USa=function(a){var b=this.k.j;zLb(this.o,a);EX(this,b,!0)};
u.cZa=function(a){var b=this.k.j,c=this.o,d=ab(a.St().getOriginalWord()),e=a.k;a=new dr;K(a,1,"\\b"+d+"\\b");K(a,3,e);K(a,6,!1);K(a,7,!1);K(a,8,!0);a.Oc(2);K(a,11,0);var f,d=c.j.o;switch(c.j.I){case "RANGE":K(a,5,0);f=to(d.rect,d.cc);K(a,9,f);f=xu(c.k,d.cc);break;case "SHEET":K(a,5,1);f=new Ai;K(f,1,""+d.cc);K(a,9,f);f=xu(c.k,d.cc);break;case "WORKBOOK":K(a,5,2),f=c.k.rY(-1,0,!1)}c.o.Ib(new eW(f.Gb(),0,a));EX(this,b,!0)};
u.x2a=function(a){var b=this.k.j;if(a){var c=this.H;c.j.contains(a.toLowerCase())||(c.j.add(a.toLowerCase()),c.dispatchEvent("ignoreWhitelistChange"))}EX(this,b,!1)};u.i_a=function(a){var b=this.k.j;if(a){var c=this.o.q,d=a.St().getOriginalWord(),e=a.getSelection();if(!ALb(c,d,e)){a=c.j[""+e.cc];a||(a=po(c.o,e.cc),a.getSheetType(),a=new Du(a.Gb(),!0),c.j[""+e.cc]=a);var c=e.Hb.y,e=e.Hb.x,f=a.Ad(c,e);f||(f=new md,Eu(a,c,e,f));f.add(d.toLowerCase())}}EX(this,b,!1)};
u.a6a=function(a){var b=this.k.j;a&&(this.A?this.A.k(a):zX.getInstance().k(a));EX(this,b,!1)};u.Gta=function(){V.u5.bd(!1);this.L.hc(this.j,"close",this.Gta);Kxa(ut.getInstance())||this.F.j(3);BLb(this.o.j);if(!V.Bi.isEnabled()){var a=ip.getInstance(),b=kp("Spellcheck will be unavailable until you reconnect.","info",!0,1E4);a.postMessage(b)}};
u.Eua=function(a){var b=this.j;R(b.Z,!1);R(b.xa,!0);var b=this.k,c=B(this.JFa,this,this.k.j,!1);this.q.im().getSelection();b.j&&(a?b.B.unshift(b.j):b.K.push(b.j));CLb(b,c,!!a)};function EX(a,b,c){var d=a.j;R(d.Z,!1);R(d.xa,!0);b=B(a.JFa,a,b,c);a.q.im().getSelection();CLb(a.k,b,!1)}
u.JFa=function(a,b){this.j.setVisible(!0);var c=this.j;R(c.Z,!0);R(c.xa,!1);var c=this.k.j,d=this.j,e=this.I,f=this.B;eh(d.yb);var h=Uh(d.O(),"docs-slidingdialog-content",d.getElement());h&&ym(h,"label",c?"Spellcheck":"No spelling suggestions");if(c){e=c.St();f=d.O();U(d).hc(d.o,"focus",d.Sua).hc(d.o,"blur",d.Rua).hc(d.F,"input",d.Uua).hc(d.o,"keydown",d.Tua);d.A.Ca("");var h=d.o,l=f.yg(f.yVa(h));Ah(l,h);d.o=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!d.o)throw Error("Replacement input not in DOM.");
N(d.removeChild(d.A));d.A=new tT("",f);d.ua(d.A);d.A.Ia(d.o);N(d.F);d.F=new oy(d.o);for(U(d).D(d.o,"focus",d.Sua).D(d.o,"blur",d.Rua).D(d.F,"input",d.Uua).D(d.o,"keydown",d.Tua);0<d.j.Ob();)d.j.Kq(0).dispose();f="Next misspelling. Change "+(e.getOriginalWord()+" to:");ym(d.o,"label",f);d.O().dg(d.bf,e.getOriginalWord());f=e.j;if(0==f.length)d.A.Ca(e.getOriginalWord()),h=new BD("No suggestions"),d.j.ua(h,!0),h.Ye(2,!1),h.$(!1),d.Ud.k(!1);else{d.A.Ca(f[0]);for(e=0;e<f.length;e++)h=new BD(f[e]),d.j.ua(h,
!0),U(d).D(h,"action",d.L$a).D(h.getElement(),"dblclick",d.l4a),1<f.length&&(h.wq(!0),h=nh("goog-menuitem-checkbox",h.Y),Fm(h,"goog-inline-block"));(e=d.j.Zb(0))&&1<d.j.Ob()&&e.Wb(!0);d.j.Li(0);d.Ud.k(!0)}cGb(d.Wa,c.getSelection());d.mgb.call(d,0,-1);DLb(d.K);d.lgb.call(d,-1);DLb(d.H);R(d.jb,!1);R(d.eb,!0)}else R(d.eb,!1),wh(d.od),e&&d.od.appendChild(e),R(d.jb,!0),e=y(f)?f:5E3,d.yb=dh(B(d.lp,d),e),d.Wa.Dv();this.j.focus();c?ELb(this.o,c.getSelection()):b&&ELb(this.o)};function FLb(a,b){this.k=a;this.j=b}FLb.prototype.St=g("j");function GLb(a,b,c){this.j=a;this.o=b;this.k=c||null}GLb.prototype.getOriginalWord=g("o");function FX(a,b,c,d,e){PV.call(this,e);this.C=a;this.B=b;this.Wa=new OV(c);this.ua(this.Wa);this.M=new Py(null,e);this.ua(this.M);this.H=new GD(e);this.Ce=new qI(null,this.H,vM.getInstance());this.ua(this.Ce);this.Ua=new Py(null,e);this.ua(this.Ua);this.K=new GD(e);this.$d=new qI(null,this.K,vM.getInstance());this.ua(this.$d);this.kc=this.U=this.I=null;this.A=new tT("",e);this.ua(this.A);this.j=new HLb(e);HD(this.j,!1);this.ua(this.j);this.yb=this.bf=this.od=this.jb=this.eb=this.F=this.o=null;this.Ud=
d;this.Z=this.xa=this.Qa=null}C(FX,PV);function DLb(a){Gm(a.Y,["goog-menu-no-icon","goog-menu-noaccel"])}u=FX.prototype;
u.L8=function(){var a;a="";var b;b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+VFb()+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><label class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</label><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false"></input>'+dGb({id:"docs-spellcheckslidingdialog-replacement-context"})+
"</td><td>"+Oy({id:"docs-spellcheckslidingdialog-button-change",style:2,yd:"docs-spellcheckslidingdialog-buttons-action",ef:"Change"})+hLb({id:"docs-spellcheckslidingdialog-button-change-menu",ir:""})+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+Oy({id:"docs-spellcheckslidingdialog-button-ignore",style:0,yd:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",ef:"Ignore"})+
hLb({id:"docs-spellcheckslidingdialog-button-ignore-menu",xe:"docs-spellcheckslidingdialog-buttons-white-menu",ir:""})+"<br/>"+Oy({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,yd:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",ef:"Add to Dictionary"})+hLb({id:"docs-spellcheckslidingdialog-button-dictionary-menu",xe:"docs-spellcheckslidingdialog-buttons-white-menu",ir:""})+"</td></tr></tbody></table></div></div></div>");return a=a+fGb({joa:"Spellcheck",
ef:""+b})};
u.aa=function(){FX.G.aa.call(this);Fm(this.Y,"docs-spellcheckslidingdialog");var a=this.O();this.xa=a.getElement("docs-spellcheckslidingdialog-loading");this.Z=a.getElement("docs-spellcheckslidingdialog-content");this.jb=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.od=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.eb=a.getElement("docs-spellcheckslidingdialog-misspellings");this.o=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.F=
new oy(this.o);this.bf=a.getElement("docs-spellcheckslidingdialog-original-word");this.Wa.Ia(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.A.Ia(this.o);this.M.Ia(a.getElement("docs-spellcheckslidingdialog-button-change"));this.Ua.Ia(a.getElement("docs-spellcheckslidingdialog-button-ignore"));ILb(this.Ce,this.M,"docs-spellcheckslidingdialog-button-change-menu",V.ska,this.C,a);ILb(this.$d,this.Ua,"docs-spellcheckslidingdialog-button-ignore-menu",V.uka,this.C,a);this.j.Ia(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
zD(this.j,!0);DLb(this.j);nD(this.C,this.Ua,V.w4,oD,B(this.B.U,this.B));nD(this.C,this.M,V.pU,oD,B(this.OVa,this));this.I=new Py(null,this.O());this.U=new GD(a);this.kc=new qI(null,this.U,vM.getInstance(),a);this.ua(this.I);this.ua(this.kc);this.I.Ia(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));nD(this.C,this.I,V.a5,oD,B(this.IP,this,this.B));ILb(this.kc,this.I,"docs-spellcheckslidingdialog-button-dictionary-menu",V.tka,this.C,a);var a=new BD("View personal dictionary..."),b=lc(oD);
delete b["node-label"];delete b.label;nD(this.C,a,V.VB,b,B(this.IP,this,this.B));this.U.ua(a,!0);DLb(this.U);U(this).D(this.j.getElement(),ud?sea:"focus",this.I9a);this.Qa=new iwb(this.getElement());M(this,this.Qa);a=Rvb("Ctrl+single-quote",!1);b=Rvb("Ctrl+semicolon",!1);Yvb(this.Qa,V.v5,a);Yvb(this.Qa,V.w5,b)};u.focus=function(){ul(this.eb)?this.A.Yi():this.jb.focus()};
function ILb(a,b,c,d,e,f){c=f.getElement(c);a.Ia(c);sV(a,1);pvb(a,b.getElement());sV(b,2);if(b=new Tw(c,a.Hd()?1:3))a.C=b,a.M=b.element;nD(e,a,d,oD)}u.lgb=function(a){for(;0<this.H.Ob();)this.H.Kq(0).dispose();var b=rh("span","docs-spellcheckslidingdialog-menu-text","Change all");a=rh("span","docs-spellcheckslidingdialog-count",0>a?"":"("+(a+" found)"));var c=[];c.push(b);c.push(a);b=new BD(c);nD(this.C,b,V.H3,void 0,B(this.cQa,this));this.H.ua(b,!0)};
u.mgb=function(a,b){for(;0<this.K.Ob();)this.K.Kq(0).dispose();var c=rh("span","docs-spellcheckslidingdialog-menu-text","Ignore all"),d=rh("span","docs-spellcheckslidingdialog-count",0>b?"":"("+(b+" found)")),e=[];e.push(c);e.push(d);c=new BD(e);nD(this.C,c,V.x4,void 0,B(this.IP,this,this.B));this.K.ua(c,!0)};function JLb(a){var b=a.A.V();a=new GLb(b,a.IP(a.B),a.B);V.pU.fireAction(a)}u.l4a=function(){JLb(this)};u.Sua=function(){var a=this.O().uz(this.o);Fm(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
u.Rua=function(){var a=this.O().uz(this.o);Hm(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};u.Tua=function(a){13==a.keyCode&&JLb(this)};u.I9a=function(){for(var a=0;a<this.j.Ob();a++){var b=this.j.Zb(a);if(b.mc()){b.Xe(!0);return}}0<this.j.Ob()&&this.j.Li(0)};function KLb(a){for(var b=0;b<a.j.Ob();b++)a.j.Zb(b).Wb(!1)}u.Uua=function(){KLb(this);this.Ud.k(!0)};u.L$a=function(a){var b=a.target.V();KLb(this);this.A.Ca(b);(a=a.target)&&1<this.j.Ob()&&a.Wb(!0);this.A.Yi()};
u.OVa=function(){var a=this.A.V();return new GLb(a,this.IP(this.B),this.B)};u.cQa=function(){var a=this.B,a=a.j?a.j.St():null;return new FLb(this.A.V(),a)};u.IP=function(a){return(a=a.j)?a.St().getOriginalWord():null};u.J=function(){eh(this.yb);N(this.F);FX.G.J.call(this)};function HLb(a,b){GD.call(this,a,b)}C(HLb,GD);HLb.prototype.Rh=function(a){return 27==a.keyCode?!1:HLb.G.Rh.call(this,a)};function LLb(a){var b="";a='<b>"'+(Y(a.oM)+'"</b> added to your personal dictionary.');return Mt(b+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function MLb(a){var b="";a='<b>"'+(Y(a.oM)+'"</b> removed from your personal dictionary.');return Mt(b+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))};function NLb(a,b){this.A=a;this.j=b;this.o=0}NLb.prototype.k=function(a){this.A.k(a);a=mp(Et(LLb,{oM:a}),V.Vp.Ig(),B(this.q,this,a),"info",!0,1E4);jp(this.j,this.o);this.o=this.j.postMessage(a)};NLb.prototype.q=function(a){this.A.q(a);a=mp(Et(MLb,{oM:a}),V.Vp.Ig(),B(this.k,this,a),"info",!0,1E4);jp(this.j,this.o);this.o=this.j.postMessage(a)};function OLb(a){L.call(this);this.o=a;this.j={};this.k=new S(this);M(this,this.k);this.k.D(a,"k",this.q)}C(OLb,L);function ALb(a,b,c){if(a=a.j[""+c.cc])if(c=a.Ad(c.Hb.y,c.Hb.x))return!!c.contains(b.toLowerCase());return!1}OLb.prototype.q=function(a){N(this.j[""+a.Ag]);delete this.j[""+a.Ag]};function GX(){H.call(this)}var PLb;C(GX,H);GX.prototype.rangeCount=function(){return fg(this,2)};function HX(){H.call(this)}var QLb;C(HX,H);HX.prototype.hb=function(){return I(this,1)};function IX(){H.call(this)}var RLb;C(IX,H);function JX(){H.call(this)}var SLb;C(JX,H);JX.prototype.EP=function(){return I(this,2)};function KX(){H.call(this)}var TLb;C(KX,H);KX.prototype.getOriginalWord=function(){return I(this,1)};
GX.prototype.Q=function(){PLb||(PLb=lg(GX,{0:{name:"SpellcheckRequest",bb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",P:5,type:Number},2:{name:"range",P:11,type:Ai},3:{name:"search_all_sheets",P:8,type:Boolean},4:{name:"active_filter_views",Jc:!0,P:11,type:HX}}));return PLb};GX.ctor=GX;GX.ctor.Q=GX.prototype.Q;
HX.prototype.Q=function(){QLb||(QLb=lg(HX,{0:{name:"FilterViewDataProto",bb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",P:9,type:String},2:{name:"filter_view_id",P:9,type:String}}));return QLb};HX.ctor=HX;HX.ctor.Q=HX.prototype.Q;
IX.prototype.Q=function(){RLb||(RLb=lg(IX,{0:{name:"SpellcheckResponse",bb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",P:5,type:Number},2:{name:"last_column_searched",P:5,type:Number},3:{name:"last_grid_id_searched",P:9,type:String},4:{name:"searched_all_sheets",P:8,type:Boolean},6:{name:"searched_whole_range",P:8,type:Boolean},5:{name:"cell_suggestions",Jc:!0,P:11,type:JX}}));return RLb};IX.ctor=IX;IX.ctor.Q=IX.prototype.Q;
JX.prototype.Q=function(){SLb||(SLb=lg(JX,{0:{name:"CellSuggestionsProto",bb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",Jc:!0,P:11,type:KX},2:{name:"cell",P:11,type:di}}));return SLb};JX.ctor=JX;JX.ctor.Q=JX.prototype.Q;
KX.prototype.Q=function(){TLb||(TLb=lg(KX,{0:{name:"PhraseSuggestionsProto",bb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",P:9,type:String},2:{name:"offset_start_index",P:5,type:Number},3:{name:"offset_end_index",P:5,type:Number},4:{name:"suggestions",Jc:!0,P:9,type:String}}));return TLb};KX.ctor=KX;KX.ctor.Q=KX.prototype.Q;function ULb(a,b){this.j=a;this.k=b}ULb.prototype.equals=function(a){return this.j.equals(a.St())&&this.k.equals(a.getSelection())};ULb.prototype.St=g("j");ULb.prototype.getSelection=g("k");function VLb(a,b){this.k=a;this.j=b}VLb.prototype.getOriginalWord=g("k");VLb.prototype.equals=function(a){var b=a.getOriginalWord();a=a.j;return this.k==b&&Sb(this.j,a)};function WLb(a,b,c){this.Hb=a;this.cc=b;this.Pd=c}WLb.prototype.equals=function(a){if(this===a)a=!0;else if(a instanceof WLb){var b;if(b=yf(a.Hb,this.Hb)&&a.cc==this.cc)a=a.Pd,b=this.Pd,b=a==b?!0:a&&b?a.start==b.start&&a.end==b.end:!1;a=b}else a=!1;return a};function LX(a,b,c,d,e){this.q=a;this.Ta=b;this.xa=c;this.Na=d;this.Z=e;this.k=this.A=this.j=null;this.C=!1;this.B=[];this.K=[];this.F=new S(this);M(this,this.F);this.H=null;this.I="RANGE";this.X=new mo;this.X.FB=!0;this.M=new mo;this.M.FB=!1}C(LX,L);LX.prototype.U=g("j");
function BLb(a,b,c){iw(a.H);a.F.Db();a.I=b;a.o=c;a.C=!1;a.B=[];a.K=[];switch(b){case "WORKBOOK":a.A=new G(-1,0);(b=a.q.rY(-1,0,!1,!0))?a.k=""+b.Va():(a.k=null,a.C=!0);break;case "SHEET":a.A=new G(-1,0);a.k=""+c.cc;break;case "RANGE":a.A=new G(c.rect.left-1,c.rect.top),a.k=""+c.cc}}
function XLb(a,b){var c=b.getSelection(),d=xu(a.q,c.cc),e;(e=!d)||(d=d.Gb(),e=c.Hb,e=!(bv(Ql(d,"r"),e.y)&&bv(Ql(d,"c"),e.x)));if(e)return!1;c=c.Pd;d=YLb(a,b);e=b.St().getOriginalWord();return d.substring(c.start,c.end)==e}function YLb(a,b){var c=ZLb(a,b);return Ga(c,"'")?c.substring(1):c}function $Lb(a,b){var c=ZLb(a,b);return Ga(c,"'")}function ZLb(a,b){var c=b.getSelection(),d=c.Hb,e=c.cc,f=xu(a.q,e).Gb(),c=Nf(c.Hb);f.Ns(c);return f.Xc(d.y,d.x).getRawValue(e,d.y,d.x)}
function aMb(a,b){if(a.k){var c=new GX,d=new Ai;K(d,1,a.k);K(d,2,a.A.y);switch(a.I){case "WORKBOOK":K(c,3,!0);Ci(d,0);for(var e=h0a(a.q),f=0;f<e.length;f++)if(0==e[f].getSheetType()){var h=e[f];bMb(c,h)}break;case "SHEET":Ci(d,0);h=xu(a.q,a.o.cc);bMb(c,h);break;case "RANGE":Ci(d,a.o.rect.gb()),Bi(d,a.o.rect.Cb()),Di(d,a.o.rect.Jb()),h=xu(a.q,a.o.cc),bMb(c,h)}K(c,2,d);K(c,1,a.A.x+1);Wo(Zo(Xo(Vo(a.Ta.se("/spell"),{data:a.X.Mb(c)})),function(a){this.Uh(a,b)},a),function(){this.Uh(null,b)},a).xd()}else cMb(a,
b,!1)}function bMb(a,b){if(b){var c=b.Gb().k;if(Ou(c)){var d=""+b.Va(),c=c.getActiveFilterId(),e=new HX;K(e,1,d);K(e,2,c);gg(a,4,e)}}}
LX.prototype.Uh=function(a,b){if(a){var c=this.M.dd(IX.Q(),a.Te());this.A=new G(I(c,2),I(c,1));this.k=I(c,3);this.C=I(c,6);for(var c=jg(c,5),d=0;d<c.length;d++)for(var e=c[d],f=e.EP().getRowIndex(),h=e.EP().getColumnIndex(),f=new G(h,f),h=parseInt(e.EP().Va(),10),e=jg(e,1),l=0;l<e.length;l++){var m=e[l],n=m.getOriginalWord(),p=I(m,2),t=I(m,3),p=new WLb(f,h,new Df(p,t));dMb(this,n,p)||(m=jg(m,4),this.B.push(new ULb(new VLb(n,m),p)))}}CLb(this,b,!1)};
function CLb(a,b,c){var d,e;c?(d=a.K,e=B(d.pop,d)):(d=a.B,e=B(d.shift,d));for(;0<d.length;){var f=e(),h=f.St().getOriginalWord();if(!dMb(a,h,f.getSelection())){e=c;h=f.getSelection();c=xu(a.q,h.cc);d=c.Gb();h=Nf(h.Hb);f=B(a.ga,a,f,b,e);d.Ns(h)?f():cf?(iw(a.H),a.H=iq(c.Hf,h).addCallback(f)):(a.F.Db(),kq(c.Hf,h,f,a.F));return}}cMb(a,b,c)}function cMb(a,b,c){a.C||c?(a.j=null,b(null)):aMb(a,b)}LX.prototype.ga=function(a,b,c){XLb(this,a)?(this.j=a,b(a.St())):CLb(this,b,c)};
function dMb(a,b,c){return a.Na.j.contains(b.toLowerCase())||ALb(a.Z,b,c)||a.xa.j.contains(b.toLowerCase())}LX.prototype.J=function(){LX.G.J.call(this);iw(this.H)};function eMb(a,b,c,d){this.k=a;this.o=b;this.j=c;this.q=d}
function zLb(a,b){var c=b.k.j;if(XLb(a.j,c)){var d=c.getSelection(),e=d.cc,f=d.Pd,h=xu(a.k,e).Gb(),l=$Lb(a.j,c),c=YLb(a.j,c),f=(l?"'":"")+c.substring(0,f.start)+b.j+c.substring(f.end),m=new xF(h,Nf(d.Hb),f);Wpa(m,B(function(a){if(a){a=this.j;for(var c=b.j,e=0;e<a.B.length;e++){var f=a.B[e].getSelection();if(yf(f.Hb,d.Hb)&&f.cc==d.cc&&f.Pd.start>d.Pd.end){var h=d.Pd,h=h.end-h.start-c.length;f.Pd.start-=h;f.Pd.end-=h}}}},a));e=new qo(e,"",Nf(d.Hb));nV(a.k,e,B(function(){this.o.Ib(m)},a))}}
function ELb(a,b){if(b){var c=new qo(b.cc,"",Nf(b.Hb));nV(a.k,c)}};function fMb(a){this.Om=new bGb(a)}fMb.prototype.j=function(a){var b=new Qj,c=new Ai;K(c,2,a.Hb.y);Bi(c,a.Hb.y+1);Ci(c,a.Hb.x);Di(c,a.Hb.x+1);K(c,1,""+a.cc);gg(b,2,c);c=new di;K(c,1,""+a.cc);c.Es(a.Hb.y);K(c,3,a.Hb.x);K(b,1,c);return this.Om.j(new mO(b))};function gMb(a,b,c,d,e,f,h){NV.call(this,"docs-spellcheckslidingdialog-id",c,B(this.tha,this));this.M=a;this.Z=new NLb(zX.getInstance(),ip.getInstance());this.K=new xLb;this.I=new OLb(a);this.A=new LX(a,e,zX.getInstance(),this.K,this.I);this.ga=new eMb(a,b,this.A,this.I);this.F=new FX((new iLb).Oa(),this.A,new fMb(a),new jLb("trigger-text",!1));this.k=new yLb(this.F,B(this.OUa,this),c,this.K,this.A,this.ga,d,this.Z);a=gh();this.o=a.R("div",{style:"margin-top: 10px"});this.B=Ry("Search the rest of the sheet",
a);this.B.render(this.o);this.q.D(this.B,"action",this.pib);this.C=Ry("Search all sheets",a);this.C.render(this.o);this.q.D(this.C,"action",B(this.tha,this,"WORKBOOK"));yL(h,zX.getInstance(),"docs-user_dictionary");V.w4.Pa("action",this.k.i_a,this.k);V.x4.Pa("action",this.k.x2a,this.k);V.a5.Pa("action",this.k.a6a,this.k);V.pU.Pa("action",this.k.USa,this.k);V.H3.Pa("action",this.k.cZa,this.k);V.v5.Pa("action",B(this.k.Eua,this.k,!1));V.w5.Pa("action",B(this.k.Eua,this.k,!0));V.VB.setVisible(!0);V.VB.Pa("action",
vLb(f,Ic(this.F)))}C(gMb,NV);u=gMb.prototype;u.pY=g("F");u.xx=function(){gMb.G.xx.call(this);this.q.D(this.j,"close",this.Nqb).D(this.M,"sheet-view-obscured",this.Oqb)};u.Nqb=function(){this.iD()};u.Oqb=function(){this.j.lp();this.iD()};
u.tha=function(a,b){var c=a,d=b||null,e;if(!c){var f=this.M.getActiveSheet();f?0==f.getSheetType()?(d=mv(f.Gb()),1<$f(d)?(c="RANGE",d=new qo(f.Va(),f.k,d)):(c="SHEET",d=new qo(f.Va(),f.k,null))):c="WORKBOOK":c="WORKBOOK"}"WORKBOOK"!=c&&(e=15E3);switch(c){case "RANGE":this.B.setVisible(!0);this.C.setVisible(!0);R(this.o,!0);break;case "SHEET":this.B.setVisible(!1);this.C.setVisible(!0);R(this.o,!0);break;case "WORKBOOK":R(this.o,!1)}BLb(this.A,c,d);c=this.k;c.I=this.o;c.B=e;V.u5.bd(!0);c.j.Tb()||c.j.render(c.C());
(e=c.j.UC)&&c.k.j?c.j.focus():(e||c.L.D(c.j,"close",c.Gta),EX(c,null,!1))};u.OUa=function(){return gh().getElement(this.Dha())};u.pib=function(){var a=this.A.o;this.tha("SHEET",new qo(a.cc,a.Pf,null))};function hMb(){L.call(this)}C(hMb,Kn);hMb.prototype.j=function(a,b,c,d,e,f,h){return new gMb(a,b,c,d,e,f,h)};Sn("spellcheck",hMb);
