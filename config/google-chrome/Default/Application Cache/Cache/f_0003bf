function lvc(a,b,c){b=vb(a,b.equals,b);0<=b&&b!=c&&(b=Cb(a,b,1),Cb(a,c,0,b[0]))}xi.prototype.getRelativityIndicatorsId=Z(45,function(){return I(this,5)});function mvc(a,b){var c=Nza.dd((new pj).Q(),b);return Sza(c,a.A,a.o,a.H)}function nvc(a,b,c){function d(a){if(a.Zr()){var b=Math.min(e,c),d=Math.max(e,c);a=a.Mr();var m=a.Ir();m==e?a.yn(c):m>=b&&m<=d&&(e>c?a.yn(m+1):e<c&&a.yn(m-1))}}var e=nb(a.q,b);lvc(a.q,b,c);F(a.k,d);F(a.j,d)}
function ovc(a,b){var c=vb(a.q,b.equals,b);if(0<=c){Fb(a.q,c);var d=function(a){if(a.Zr()){var b=a.Mr(),d=b.Ir();d==c?a.vC():d>c&&b.yn(d-1)}};F(a.k,d);F(a.j,d)}}function pvc(a,b,c){null!=c?(Bb(a.q,b,c),b=function(a){if(a.Zr()){a=a.Mr();var b=a.Ir();b>=c&&a.yn(b+1)}},F(a.k,b),F(a.j,b)):a.q.push(b)}
function qvc(a,b){var c=0,d=0,e=new xi;b.Rc||(c=b.ib(),K(e,1,c),c=b.Cb(),K(e,2,c),c=2);b.isRow()||(d=b.gb(),K(e,3,d),d=b.Jb(),K(e,4,d),d=2);c=ritz.getRelativityIndicatorsId(c,c,d,d,!0);K(e,5,c);K(e,6,""+a);c=new wi;K(c,2,0);K(c,1,e);return c}function rvc(a,b){K(a,3,b)}function svc(a){return kg(a,3)}function tvc(a,b){K(a,2,b)}function S9(a){return I(a,4)}function uvc(a,b){K(a,3,b)}function vvc(a,b){K(a,8,b)}function wvc(a){return kg(a,8)}function xvc(a,b){K(a,2,b)}function yvc(a,b){K(a,3,b)}
function zvc(a){return I(a,2)}function Avc(a,b,c){var d=b.ib();b=b.gb();a=a?a.Xc(d,b+c).getDisplayValue():"";""==a&&(a="Column "+Js(b+c));return a}function T9(a,b){sF.call(this,1602,b);this.j=a}C(T9,sF);T9.prototype.Ac=function(){return{}};T9.prototype.fd=r(47);T9.prototype.cd=function(){var a=new Sr,b=Tza(this.j);K(a,1,b);return a};function U9(a,b){O.call(this,a,b)}C(U9,O);function Bvc(a){a=""+Ut(pV(Qt(a,{title:Rt("Report Editor"),ef:St('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+Ut(Ny({yd:"goog-inline-block waffle-pivot-label-button",content:St("Edit range..."),id:"waffle-pivot-range-selection-button",style:4}))+
'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+Cvc({Cr:Rt("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+Cvc({Cr:Rt("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
Cvc({Cr:Rt("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+Cvc({Cr:Rt("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return Mt(a)}function Cvc(a){var b;b=""+('<strong id="'+Vt(a.id)+'-field-label">'+Y(a.Cr)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=Rt("Add field");b+=Ut(Ny({yd:"goog-inline-block waffle-pivot-label-button",content:c,attributes:Tt('aria-label="'+Vt(a.Cr)+" "+Vt(c)+'"'),id:a.id,style:4}));return Mt(b)}
function Dvc(a){return Mt('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+Y(a.VW)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function V9(a,b,c,d,e){Wm.call(this,e);this.F=a;this.I=c;this.H=d;this.be(b)}C(V9,Wm);u=V9.prototype;u.Da=function(){this.Y=Et(Dvc,{VW:this.F})};u.aa=function(){V9.G.aa.call(this);var a=this.O(),b=U(this);this.B=Sh(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c=new Py("\u2715",a,4);c.render(Sh(a,"td","waffle-pivot-pill-close",this.getElement())[0]);Cm(c.getElement(),"Close edit field and remove from pivot table");M(this,c);b.D(c,"action",this.bqb)};
u.vB=function(){var a=new U9("pivot-pill-changed",this);a.k=this;this.dispatchEvent(a)};function W9(a,b){a.B&&(a.O().dg(a.B,b),Cm(a.getElement(),"Edit field: "+(a.F+(" "+(b+".")))),a.B.title=b)}function Evc(a){return a.O().eJ(a.B)}function X9(a,b){return Avc(a.I,a.H,b)}function Z9(a,b,c){a=a.O();return a.R("span",c,a.createTextNode(b+"\u00a0"))}function $9(a){return a.O().R("div","waffle-pivot-pill-nodrag")}
u.XL=function(a){var b=this.O(),c=b.R("div","waffle-pivot-pill-section",arguments);1<Bh(this.getElement()).length&&Fm(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};u.Kx=function(a){U(this).D(a.getElement(),"mouseover",this.K2).D(a.getElement(),"mouseout",this.K2)};u.K2=function(a){Wla(a.target,"waffle-pivot-select-hover")};u.Ym=g("H");u.Gb=g("I");u.bqb=function(){var a=new U9("pivot-remove-pill",this);a.k=this;this.dispatchEvent(a)};function a$(){}C(a$,JD);ka(a$);a$.prototype.Eb=r("waffle-pivot-select");a$.prototype.GC=function(a){return a.R("div","goog-inline-block "+(this.Eb()+"-dropdown"),"\u00a0\u25be")};function i$(a,b,c,d){V9.call(this,"Filter:",a,b,c,d);this.j=new YF("",null,a$.getInstance(),d);M(this,this.j)}C(i$,V9);u=i$.prototype;u.aa=function(){i$.G.aa.call(this);this.getModel();W9(this,X9(this,Fvc(this)));var a=Z9(this,"Show:"),b=$9(this);this.j.Ia(b);this.j.as=!0;this.j.qw("Loading...");Cm(this.j.Y,"Show:");var c=new Gvc;M(this,c);this.j.De(c);this.Kx(this.j);this.XL(a,b)};u.be=function(a){i$.G.be.call(this,a);W9(this,X9(this,Fvc(this)))};
function Fvc(a){return a.getModel().getColumnIndex()-a.Ym().gb()}function j$(a){return a.j.Ab().j}u.Kx=function(a){i$.G.Kx.call(this,a);U(this).D(j$(this),"filters_selected",this.Opb).D(j$(this),"filtering_cancelled",this.Ppb)};function Hvc(a,b,c){var d=[];if(!c)return d;a=b.gb()+a;var e=Uf(b,"r");for(b=b.ib()+1;b<e.end;b++){var f=c.Xc(b,a);Ub(d,f.getDisplayValue(),yFb)}return d}
function Ivc(a){var b=j$(a),c=zvc(a.getModel()).o(),d=new md(c),e=rb(k7(b),function(a,b){return d.contains(b)?a-1:a},k7(b).length);vFb(b,c);Jvc(a,e)}function Jvc(a,b){var c=j$(a);0==b?a.j.qw(zmc()):(c=k7(c).length-b,a.j.qw(zmc(c)))}u.Opb=function(a){this.j.ed(!1);Jvc(this,a.K.length);this.vB()};u.Ppb=function(){this.j.ed(!1);var a=this.j.Y;try{ud&&this.O().pb().body.focus(),a.focus()}catch(b){}Ivc(this)};function Gvc(a){GD.call(this,a);this.j=new DV([],a)}C(Gvc,GD);
Gvc.prototype.aa=function(){Gvc.G.aa.call(this);this.j.render(this.kb());var a=new my(this.j.Y,this.O());ny(a);M(this,a)};function k$(a,b,c,d,e){V9.call(this,"Group by:",a,b,c,e);this.K=d}C(k$,V9);u=k$.prototype;
u.aa=function(){k$.G.aa.call(this);var a=this.getModel();W9(this,X9(this,a.Xf()));var b=this.O(),a=Z9(this,"Order:"),c=$9(this),d=new GD;d.ua(new BD(b.yg("Ascending"),0),!0);d.ua(new BD(b.yg("Descending"),1),!0);b=this.o=new YF("",d,a$.getInstance(),b);b.Ia(c);b.Ca(wvc(this.getModel()));Cm(b.getElement(),"Order:");this.Kx(b);this.XL(a,c);var b=this.O(),c=Z9(this,"Sort by:"),a=$9(this),d=new GD,e=X9(this,this.getModel().Xf());d.ua(new BD(e,-1),!0);d=this.A=new YF("",d,a$.getInstance(),b);d.Ia(a);Cm(d.getElement(),
"Sort by:");U(this).D(d.getElement(),"mouseover",this.K2).D(d.getElement(),"mouseout",this.K2).D(d,"action",this.Hpb);b=B(b.R,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.C=b(a);this.XL(c,this.C);a=this.getModel();a=kg(a,2);c=Z9(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=$9(this);Fm(b,"goog-inline-block");this.k=new ZI;XI(this.k,c);this.k.Wb(a);this.k.render(b);U(this).D(this.k,"change",this.vB);this.XL(b,c)};
u.be=function(a){k$.G.be.call(this,a);W9(this,X9(this,a.Xf()));this.k&&this.k.Wb(kg(a,2));this.o&&this.o.Ca(wvc(a))};u.isRow=g("K");u.Hpb=function(a){a=new U9("pivot-sort-by-change",a.currentTarget);a.k=this;this.dispatchEvent(a)};u.Ipb=function(a){a=new U9("pivot-sort-key-change",a.currentTarget);a.k=this;this.dispatchEvent(a)};function Kvc(a){var b=[];if(a.j)for(var c=a.j.Ob(),d=0;d<c;d++)0<=a.j.Zb(d).V()&&b.push(a.j.Zb(d).hg());return b}
function Lvc(a){if(!a.j){var b=a.O(),c=$9(a);Fm(c,"waffle-pivot-multi-select");a.j=new sD("horizontal",null,b);a.j.Ia(c);b.appendChild(a.C,c)}}u.Kx=function(a){k$.G.Kx.call(this,a);U(this).D(a,"hide",this.vB)};u.J=function(){k$.G.J.call(this);N(this.o);N(this.A);N(this.j);N(this.k);this.C=null};function Mvc(){Q.call(this);this.k="";this.j=!1}C(Mvc,Q);Mvc.prototype.V=g("k");Mvc.prototype.Ca=function(a){this.k=a;this.j=!0;this.dispatchEvent("change")};function l$(a,b,c,d){V9.call(this,"Display:",a,b,c,d);this.k=this.A=this.j=null;this.o=0}C(l$,V9);var Nvc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" ");u=l$.prototype;u.aa=function(){l$.G.aa.call(this);W9(this,Ovc(this));Pvc(this)};
function Pvc(a){var b=a.O(),c=Z9(a,"Summarize by:"),d=$9(a),e=a.getModel();if(1==S9(e)){var f=new GD;F(Nvc,function(a){f.ua(new BD(a),!0)});b=a.j=new YF("",f,a$.getInstance(),b);b.Ia(d);b.Ca(I(e,5).Rt());Cm(b.getElement(),"Summarize by:");a.Kx(b)}else{a.j=null;var h=Z9(a,"Name"),l=$9(a),m=new tT(void 0,b);m.render(l);Cm(m.Y,"Name");eg(e,3)&&m.Ca(kg(e,3));Qvc(a,m);a.k=m;a.XL(h,l);b=new tT(void 0,b);b.render(d);b.Ca(svc(I(e,6))||"=");Cm(b.Y,"Formula");d.appendChild(b.getElement());Qvc(a,b);a.A=b}a.XL(c,
d)}u.V=function(){return this.j?this.j.V():this.A.V()};function Rvc(a){return a.k&&(a=a.k.V())&&""!=a?a:null}u.Kx=function(a){l$.G.Kx.call(this,a);U(this).D(a,"hide",this.vB)};u.be=function(a){var b=S9(a);null!=this.getModel()&&S9(this.getModel());l$.G.be.call(this,a);W9(this,Ovc(this));1==b?null!=this.j&&this.j.Ca(I(a,5).Rt()):null!=this.k&&null!=this.A&&(eg(a,3)&&this.k.Ca(kg(a,3)),this.A.Ca(svc(I(a,6))||"="))};
function Ovc(a){var b=a.getModel();return 1==S9(b)?X9(a,I(b,5).Xf()):"Calculated Field"}function Qvc(a,b){var c=new oy(b.Y);M(a,c);U(a).D(c,"input",a.s3a)}u.s3a=function(){this.o&&(clearTimeout(this.o),this.o=0);this.o=setTimeout(B(function(){this.vB();this.o=0},this),100)};u.J=function(){l$.G.J.call(this);N(this.j)};function m$(a,b,c,d,e){qV.call(this,e);a=this.O();var f=Svc,h=Tvc;this.Ua=b;this.Xb=c;this.Wa=d;this.j={};this.A=!0;this.jb=null;this.I=new Mvc;this.U=new S(this);this.Z=new fW;this.M=[];this.xa=this.o=null;this.eb=new BD("No fields left to add",void 0,e);this.eb.$(!1);this.B=this.C=null;this.Qa=pc(f.A3,h.pv,f.y3,h.Us,f.z3,h.hN,f.x3,h.wM);this.F=this.K=null;b=new GD(a);b.ua(new BD("Columns",2,a),!0);b.ua(new BD("Rows",1,a),!0);this.H=new YF("",b,a$.getInstance(),a)}C(m$,qV);
var Svc={pv:"waffle-pivot-values",Us:"waffle-pivot-filter",T3:"waffle-pivot-column-label",m5:"waffle-pivot-row-label",A3:"waffle-pivot-add-field-value",y3:"waffle-pivot-add-field-filter",z3:"waffle-pivot-add-field-row",x3:"waffle-pivot-add-field-column",B3:"waffle-pivot-aggr-select",C3:"waffle-pivot-aggr",yGa:"waffle-pivot-apply",Q3:"waffle-pivot-button-container",MKa:"waffle-pivot-range-selection",NKa:"waffle-pivot-range-selection-button",OKa:"waffle-pivot-range-text",nN:"waffle-pivot-button-update",
G5:"waffle-pivot-update-auto",H5:"waffle-pivot-update-manual"},Tvc={hN:"row-breakout",wM:"col-breakout",Us:"filter",pv:"aggregation"};u=m$.prototype;u.Da=function(){this.Y=Et(Bvc,{id:this.getId()})};
u.aa=function(){function a(a,b){f.D(kh(a),"click",b)}m$.G.aa.call(this);var b=this.O(),c=Svc;R(b.getElement(c.Q3),!1);var d=Tvc;this.B=pc(d.pv,b.getElement(c.pv),d.Us,b.getElement(c.Us),d.hN,b.getElement(c.m5),d.wM,b.getElement(c.T3));this.jb=b.getElement(c.nN);var d=ry(vM,""),e=vmc(),f=U(this),h;for(h in this.Qa){var l=new KD("",new GD(b,e),d,b);M(this,l);l.Ia(b.getElement(h));f.D(l,"show",this.rqb).D(l.Ab(),"action",this.qqb)}a(c.nN,this.Bqb);a(c.G5,this.BEa);a(c.H5,this.BEa);this.F=b.getElement(c.C3);
R(this.F,!1);this.H.Ia(b.getElement(c.B3));f.D(this.H,"action",this.sqb);this.xa=new Tm(this.kb());f.D(this.xa,"focusin",this.wqb).D(this.xa,"focusout",this.xqb);Uvc(this)};u.wqb=function(a){this.o=Vvc(this,a.target)};u.xqb=function(a){if(a=a.relatedTarget){var b=this.kb();Nh(a,function(a){return a==b})||(this.o=null)}};
function Vvc(a,b){if(!b)return null;var c=a.O().Bqa(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;ac(a.j,function(a,b){return(d=ub(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:Evc(d)}:null}
function Wvc(a){var b=a.O();if(a.o){var c=a.o.container,d=a.j[c];if(d&&a.o.label)for(var e=0,f;f=d[e];e++)if(Evc(f)==a.o.label){n$(a,f.getElement());return}d&&0<d.length?n$(a,d[d.length-1].getElement()):(d=fc(a.Qa,function(a){return a==c}),n$(a,b.getElement(d)))}}
u.be=function(a){m$.G.be.call(this,a);a?(Xvc(this,function(){function b(a,b){if(a)for(;a.length>b;)N(a.pop())}function c(a,b,c){var d="row-breakout"==a;this.j[a]&&this.j[a][c]?(c=this.j[a][c],c.be(b),a=new U9("pivot-pill-model-updated"),a.k=c,this.dispatchEvent(a)):(c=new k$(b,o$(this),p$(this),d,this.O()),c.render(),Yvc(this,c,a))}var d=a.km(),d=ritz.renderPivotTableCalculatedFieldFormulas(a.R9(),d);a=mvc(a,d);F(a.Qt(),function(a,b){if(this.j.filter&&this.j.filter[b]){var c=this.j.filter[b];c.be(a)}else c=
new i$(a,o$(this),p$(this),this.O()),c.render(),Yvc(this,c,"filter")},this);F(a.co(),Aa(c,"row-breakout"),this);F(a.$n(),Aa(c,"col-breakout"),this);F(a.Lt(),function(a,b){var c=null;this.j.aggregation&&this.j.aggregation[b]&&(c=this.j.aggregation[b]);c&&S9(c.getModel())==S9(a)?c.be(a):(c&&N(c),c=new l$(a,o$(this),p$(this),this.O()),c.render(),Yvc(this,c,"aggregation"))},this);b(this.j["row-breakout"],a.co().length);b(this.j["col-breakout"],a.$n().length);b(this.j.filter,a.Qt().length);b(this.j.aggregation,
a.Lt().length);d=(d=(d=xu(this.Wa.j,a.Tt()))?d.k:null)?Vs(a.Ym(o$(this)),d):"#REF!";Zvc(this,d);this.I.Ca(d);(d=this.j.aggregation)&&2<=d.length?(R(this.F,!0),this.H.Ca(a.Vo())):R(this.F,!1)}),m$.G.be.call(this,a),$vc(this,function(){var a=this.j.filter;a&&F(a,function(a){var b=j$(a),e;e=Hvc(Fvc(a),a.Ym(),a.Gb());uFb(b,e);Ivc(a)},this)})):this.reset()};u.focus=function(){m$.G.focus.call(this);n$(this,nh("waffle-sidebar-title",this.getElement()))};
function Yvc(a,b,c){a.B[c].appendChild(b.getElement());a.j[c]||(a.j[c]=[]);a.j[c].push(b);b.dc(a);awc(a,b);Uvc(a)}function awc(a,b){U(a).D(b,"pivot-remove-pill",a.Aqb).D(b,"pivot-pill-changed",a.zqb).D(b.getElement(),"keydown",a.yqb);var c=new U9("pivot-pill-created");c.k=b;a.dispatchEvent(c)}function Uvc(a){a.U.Db();N(a.Z);var b=a.Z=new fW;Yb(a.B,function(a){DGb(b,a)});b.vd();a.U.D(b,"beforedragstart",a.tqb).D(b,"dragstart",a.vqb).D(b,"dragend",a.uqb)}
u.reset=function(){Yb(this.j,function(a){F(a,N)});this.j={}};function Zvc(a,b){var c=a.O();c.dg(c.getElement("waffle-pivot-range-text"),b)}u.Aqb=function(a){var b=new U9("pivot-pill-removed",this);b.k=a.target;b.container=fc(this.j,function(b){return wb(b,a.target)});b.container&&(Eb(this.j[b.container],a.target),this.o={container:b.container,label:null},this.dispatchEvent(b))};u.zqb=function(a){a.container=fc(this.j,function(b){return wb(b,a.target)})};
u.yqb=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||bwc(this,a.target,38==a.keyCode)};function bwc(a,b,c){var d=null,e=-1;ac(a.B,function(a,c){e=nb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.j[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){Bmc(f,e,c);var h=new U9("pivot-pill-changed",a);h.k=f[c];h.container=d;h.B=d;h.position=c;h.M=!0;a.dispatchEvent(h)}}u.Bqb=function(){this.dispatchEvent("pivot-table-update")};
u.BEa=function(a){a=this.A="autoupdate"==a.target.value;(this.jb.disabled=a)&&this.dispatchEvent("pivot-table-update")};u.sqb=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};u.Vo=function(){return this.H.V()};function cwc(a,b,c,d){Wg(a.C);lFb(a.Ua,a.I,a.I.V(),!1,!1,!0,B(a.Cqb,a,b,c,!!d))}
u.Cqb=function(a,b,c,d){var e=this.I,f=this.Wa;e.j=!1;var h=e.V();this.C=Ug(d,"afterhide",function(){if(e.j){var d=Ss(e.V(),f.j,!0,!0);d?a(d):(e.Ca(h),b())}else b();c||n$(this,kh("waffle-pivot-range-selection-button"))},!1,this)};
u.rqb=function(a){var b=a.target.getParent(),c=b.Ab();this.K=this.Qa[b.Y.id];Xvc(this,function(){var a=this.K,e=o$(this),f=p$(this),h=dwc(this,a);c.kd(!0);for(var l=Uf(f,"c"),m=0,n=l.start;n<l.end;n++){var p=Avc(e,f,m);p&&!h[p]&&c.ua(new BD(p,m),!0);m++}"aggregation"==a&&(c.ua(new FD,!0),c.ua(new BD("Calculated Field",-1),!0));0==c.Ob()&&c.ua(this.eb,!0);SS(b,!0);b.wu();SS(b,!1)})};function n$(a,b){try{ud&&a.O().pb().body.focus(),b.focus(),a.Xb.j(2)}catch(c){}}
u.qqb=function(a){var b=this.K;a=a.target.V();var c=new U9("pivot-pill-added",this);c.container=b;c.Z=a;this.o={container:b,label:null};this.dispatchEvent(c)};u.tqb=function(a){for(var b=a.event.target||a.event.k.target;b instanceof Element&&!Em(b,"waffle-pivot-pill");b=b.parentNode)if(Em(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};u.vqb=function(a){var b=yl(a.k).width;ol(a.B,b)};
u.uqb=function(a){var b,c,d,e,f=new U9("pivot-pill-changed",this);ac(this.B,function(c,d){e=nb(c.childNodes,a.k);return 0<=e?(b=d,!0):!1});ac(this.j,function(b,e){var m=ub(b,function(b){return b.getElement()==a.k});return m?(c=e,f.k=d=m,!0):!1});this.j[b]||(this.j[b]=[]);Eb(this.j[c],d);Bb(this.j[b],d,e);f.container=b;f.B=c;f.position=e;this.dispatchEvent(f)};
function dwc(a,b){function c(a){a=h(a.kz()-l);f[a]=!0}function d(a){a=h(a.Xf());f[a]=!0}var e=a.getModel(),f={},h=B(Avc,a,o$(a),p$(a)),l=p$(a).gb();if(e)switch(b){case "filter":F(e.Qt(),c);break;case "row-breakout":case "col-breakout":F(e.co(),d),F(e.$n(),d)}return f}function Xvc(a,b){var c=ewc(a);if(c){var d=p$(a),d=new Lf(d.ib(),d.gb(),d.ib()+1,d.Jb());cf?fwc(a,d,b):kq(c.Hf,d,B(b,a),U(a))}else b.call(a)}function $vc(a,b){var c=ewc(a);c?cf?fwc(a,p$(a),b):kq(c.Hf,p$(a),B(b,a),U(a)):b.call(a)}
function fwc(a,b,c){b=iq(tu(ewc(a)),b).addCallback(c,a);a.M.push(b);tm(b,Aa(Eb,a.M,b))}function ewc(a){var b=a.getModel();return xu(a.Wa.j,b.Tt())}function o$(a){return(a=ewc(a))?a.Gb():null}function p$(a){return a.getModel().Ym(o$(a))}function gwc(a,b,c){return vb(a.j[b],function(a){return c.getElement()==a.getElement()})}u.J=function(){m$.G.J.call(this);Yb(this.j,function(a){Hg(a)});this.j={};Wg(this.C);this.C=null;N(this.Z);N(this.U);F(this.M,iw)};function q$(a,b){L.call(this);this.j=a;this.q=b;this.k=new S(this);M(this,this.k);this.k.D(a,"pivot-pill-created",this.o).D(a,"pivot-pill-model-updated",this.o)}C(q$,L);q$.prototype.A=function(a){var b=a.k;-1==a.target.V()?(b.j&&(N(b.j),b.j=null),b.vB()):0<hwc(this,b).length&&!b.j?(Lvc(b),b.j.getElement().focus(),iwc(this,b,-2,!0)):b.vB()};
q$.prototype.B=function(a){var b=a.k;a=a.target;var c=bn(b.j,a),d=b.O();for(c++;c<b.j.Ob();){var e=b.j.Zb(c),f=d.Bra(e.getElement());Em(f,"waffle-pivot-select-divider")&&d.xf(f);b.j.removeChild(e,!0)}(0>a.V()||!iwc(this,b,-2,!0))&&b.vB()};function jwc(a,b){a.k.D(b,"pivot-sort-by-change",a.A).D(b,"pivot-sort-key-change",a.B)}
q$.prototype.o=function(a){var b=a.k;if(b instanceof k$){a=b.getModel();for(var c=0<hwc(this,b).length,d=this.j.getModel().Lt(),e=b.A,f=e.Ki()-1;1<=f;f--)e.TD(f);e.Ad(0).qw(X9(b,a.Xf()));e.Xd(0);F(d,function(a,d){var f;if(eg(a,3))f=I(a,3);else if(1==S9(a)){f=I(a,5).getFunctionName();var n=X9(b,I(a,5).Xf());f=c?f+(" of "+(n+" in...")):f+(" of "+n)}else f=svc(I(a,6));e.pd(new BD(f,d))});a.Zr()&&(d=a.Mr(),a=d.ZS(),kwc(this,b,a)&&(d=d.Ir(),e.Ca(d),c&&(Lvc(b),F(a,B(function(a){iwc(this,b,a,!1)},this)),
iwc(this,b,-1,!1))));jwc(this,b)}};
function iwc(a,b,c,d){var e=lwc(a,b);if(0==e.length)return!1;var f=b.j.Ob();a=hwc(a,b);if(f>=a.length)return!1;var h=X9(b,a[f].Xf()),f=b.O();a=b.j.Ob();var l=new GD,m=new BD(h,-2);m.$(!1);l.ua(m,!0);l.ua(new BD(0==a?"Grand Total":"Total",-1),!0);for(m=0;m<e.length;m++)l.ua(new BD(e[m],m),!0);h=new YF(h,l,a$.getInstance(),f);h.Ca(-2);b.j.ua(h,!0);0<a&&(a=f.R("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.fu(a,h.getElement()));U(b).D(h,"action",b.Ipb);f=c;"string"==typeof c&&(f=nb(e,
c),-1==f&&(f=-2));h.Ca(f);d&&(b.j.Xe(h),h.ed(!0));return!0}function lwc(a,b){var c=mwc(a,b),d=Kvc(b),e=d.length,f=[];F(c,function(a){a.length==e+1&&tb(d,function(b,c){return a[c]==b})&&Ub(f,a[e])});return f}function kwc(a,b,c){a=mwc(a,b);return 0==c.length||sb(a,function(a){return Sb(c,a)})}function hwc(a,b){return b.isRow()?a.j.getModel().$n():a.j.getModel().co()}function mwc(a,b){return b.isRow()?Oza(a.j.getModel(),a.q):Pza(a.j.getModel(),a.q)};function r$(a,b){Xs.call(this,1601,b,Nf(a.o));this.j=a}C(r$,Xs);r$.prototype.exec=ba();r$.prototype.Ac=function(){return{}};r$.prototype.fd=r(48);r$.prototype.cd=function(){var a=new Tr,b=Tza(this.j);K(a,2,b);var b=this.j.o,c=new di;K(c,1,""+this.j.km());c.Es(b.y);K(c,3,b.x);K(a,1,c);return a};function nwc(a,b,c,d,e){oV.call(this,a,c);this.j=a;this.k=b;this.F=d;this.B=e;this.H=new q$(this.j,this.k);M(this,this.H);b=b.j;c=a.O();this.L.D(a,"pivot-table-update",this.lqb).D(a,"pivot-pill-added",this.dqb).D(a,"pivot-pill-removed",this.fqb).D(a,"pivot-pill-changed",this.eqb).D(a,"pivot-aggregation-orientation-changed",this.cqb).D(Vn,"show-pivot-ritz",this.kqb).D(e,"activeCellChange",this.sha).D(e,"click",this.mqb,!0).D(e,"pivot_table_zippy_toggle",this.nqb).D(b,"a",this.sha).D(b,"d",this.jqb).D(c.getElement("waffle-pivot-range-selection-button"),
"click",this.gqb).D(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.hqb);a=["Xa"];a.push("ha");this.L.D(Cu(b),a,this.sha)}C(nwc,oV);u=nwc.prototype;u.L2=null;u.wB=null;u.Wg=function(){return X.d5};u.pq=function(){return X.c5};u.gqb=function(){owc(this)};u.hqb=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),owc(this))};function owc(a){cwc(a.j,B(a.iqb,a,s$(a)),ja)}
u.iqb=function(a,b){a.A=b.cc;var c=qvc(b.cc,b.rect);a.A=parseInt(I(c,1).Va(),10);a.C=c;t$(this,a,this.j.A,!1);var c=a.km(),d=this.k.j;ss(d)!=c&&aw(d,c)};u.kqb=function(){if(!xf(Se.getInstance())){var a=this.j;if(!a.Ea()){var b=this.k.j.getActiveGrid(),c=u$(this);if(!c&&b){this.j.reset();var a=b.Hf,c=b.Gb(),d=uv(c),e=sv(c);d?(cf?mq(a,e,cc(Fd)):oq(a,e,cc(Fd),this.L)).addCallback(B(this.AEa,this,b)):this.AEa(b,mv(c));return}this.wB=c;a.be(c)}this.pq().fireAction()}};
u.eqb=function(a){var b=a.container,c=a.B,d=a.k,e=a.k.getModel(),f=d;if(d&&c&&b!=c){f=pwc(this,d.getModel(),b);t:{var h=this.j;switch(b){case "row-breakout":case "col-breakout":var l="row-breakout"==b,f=new k$(f,o$(h),p$(h),l,h.O());break t;case "aggregation":f=new l$(f,o$(h),p$(h),h.O());break t;case "filter":f=new i$(f,o$(h),p$(h),h.O());break t;default:f=null}}f.render();h=this.j;l=f;h.O().QA(l.getElement(),d.getElement());var m=h.j[b],n=nb(m,d);Cb(m,n,1,l);N(d);l.dc(h);awc(h,l);Uvc(h)}d=s$(this);
h=a.position;l=c==b;m=qwc(this,f.getModel());if(c)if(l){f=f.getModel();switch(b){case "row-breakout":lvc(d.k,f,h);break;case "col-breakout":lvc(d.j,f,h);break;case "filter":lvc(d.B,f,h);break;case "aggregation":nvc(d,f,h)}Yn(ymc(h))}else rwc(this,b,d,m,h);else swc(this,b,f,d);c&&!l&&twc(e,c,d);t$(this,d,this.j.A,!!a.M)};
function pwc(a,b,c){switch(c){case "row-breakout":case "col-breakout":if(b instanceof lj)return b;break;case "aggregation":if(b instanceof mj)return b;break;case "filter":if(b instanceof fj)return b;break;default:return null}b=qwc(a,b);-1==b&&(b=0);switch(c){case "row-breakout":case "col-breakout":return c=new lj,K(c,1,b),c;case "aggregation":return c=new mj,a=new nj,K(a,1,b),tvc(a,"SUM"),K(c,4,1),K(c,5,a),c;case "filter":return c=new fj,new gj,a=b+uwc(a).gb(),K(c,1,a),c;default:return null}}
function qwc(a,b){if(b instanceof lj)return b.Xf();if(b instanceof mj)switch(S9(b)){case 1:return I(b,5).Xf();case 2:return-1;default:return 0}return b instanceof fj?b.getColumnIndex()-uwc(a).gb():0}function uwc(a){var b=u$(a);return b.Ym(xu(a.k.j,b.Tt()).Gb())}u.dqb=function(a){var b=a.container,c=s$(this);rwc(this,b,c,a.Z,a.position);t$(this,c,this.j.A,!1)};u.fqb=function(a){var b=s$(this);twc(a.k.getModel(),a.container,b);N(a.k);t$(this,b,this.j.A,!1)};
u.cqb=function(){var a=s$(this),b=this.j.Vo();a.F=b;t$(this,a,this.j.A,!1)};
function rwc(a,b,c,d,e){switch(b){case "row-breakout":a=new lj;K(a,1,d);d=a;null!=e?Bb(c.k,d,e):c.k.push(d);break;case "col-breakout":a=new lj;K(a,1,d);d=a;null!=e?Bb(c.j,d,e):c.j.push(d);break;case "filter":b=xu(a.k.j,c.Tt()).Gb();b=Hvc(d,c.Ym(b),b);var f=new fj;d=uwc(a).gb()+d;K(f,1,d);vwc(f,b);null!=e?Bb(c.B,f,e):c.B.push(f);break;case "aggregation":a=new mj,-1==d?(d=new oj,rvc(d,""),K(a,4,2),K(a,6,d)):(b=new nj,K(b,1,d),tvc(b,"SUM"),K(a,4,1),K(a,5,b)),pvc(c,a,e)}}
function twc(a,b,c){switch(b){case "row-breakout":Hb(c.k,a.equals,a);break;case "col-breakout":Hb(c.j,a.equals,a);break;case "filter":Hb(c.B,a.equals,a);break;case "aggregation":ovc(c,a)}}
function swc(a,b,c,d){if("aggregation"==b)a=gwc(a.j,b,c),d=d.Lt()[a],null!=d&&(Rvc(c)&&uvc(d,kb(Rvc(c))),1==S9(d)?tvc(I(d,5),c.V()):(kb(2==S9(d)),rvc(I(d,6),c.V())));else if("filter"==b)d=ub(d.Qt(),function(a){return a.equals(c.getModel())}),null!=d&&vwc(d,wFb(j$(c),!0));else if(d=ub("row-breakout"==b?d.co():d.$n(),function(a){return a.equals(c.getModel())}),null!=d)if(xvc(d,c.k.mc()),vvc(d,c.o.V()),-1!=c.A.V()){var e=new kj;e.yn(c.A.V());F(Kvc(c),function(a){gg(e,2,a)});yvc(e,c.o.V());K(d,7,e)}else d.vC()}
u.lqb=function(){t$(this,u$(this),!0,!1)};function t$(a,b,c,d){b&&(c?(c=ms(a.k.j,b.km()),c=new r$(b,c),a.F.Ib(c),a.L2=null):a.L2=b,c=a.j.getModel(),(d=d||!yf(c.o,b.o))&&a.j.reset(),a.j.be(b),d&&Wvc(a.j))}u.AEa=function(a,b){var c=a.Gb(),d=uv(c),c=sv(c);d&&b.equals(c)?cwc(this.j,B(this.zEa,this),B(this.oqb,this),!0):this.zEa(new qo(a.Va(),a.k,b))};u.oqb=function(){this.Wg().setVisible(!1);this.C.j(3)};
u.zEa=function(a){var b;b=new pj;var c=qvc(0,new Lf(0,0,1,1));K(b,6,c);K(b,5,2);b=Sza(b,0,new G(0,0),0);b.A=a.cc;a=qvc(a.cc,a.rect);b.A=parseInt(I(a,1).Va(),10);b.C=a;a=ss(this.k.j);this.F.Ib(new T9(b,a))};function u$(a){if(a.L2)return a.L2;(a=a.k.j.getActiveSheet())&&0==a.getSheetType()?(a=a.Gb(),a=BBa(a,qv(a))):a=null;return a}function s$(a){return(a=u$(a))?a.clone():null}
u.sha=function(a){var b=u$(this);if(("Xa"==a.type||"ha"==a.type)&&!b&&this.wB&&(a=this.k.j.getActiveGrid())&&(a=a.Gb(),a.hb()==this.wB.km())){var c=this.wB.o;c&&(vv(a,c),b=u$(this))}b&&!b.equals(this.wB,this.k)&&this.j.be(b);this.wB=b;this.Wg().setVisible(!!b&&!vE(this.k))};u.jqb=function(a){a=a.target;if(this.wB&&this.wB.km()==a.Va()&&this.j.Ea()){a=this.j;var b=Nya(a.Ua);b&&a.C&&b.setVisible(!1)}};
u.mqb=function(a){var b=a.target;if(Em(b,wmc.Qka)||Em(b,wmc.Pka)){var b=ou(this.B).getModel(),c=iv(b,a.zf);wwc(this,b,c);a.stopPropagation()}};u.nqb=function(a){var b=ou(this.B).getModel();a=iv(b,a.zf);wwc(this,b,a)};
function wwc(a,b,c){if(!vE(a.k)){var d=c.Rj();b=BBa(b,c);if(c=d.JP()){var e=c.length-1;c=c[e];for(var d="r"==d.sD()?b.co()[e]:b.$n()[e],e=jg(d,3),f,h=0;h<e.length;h++)if(e[h].V()==c){f=e[h];var l=!I(f,3);K(f,3,l)}f||(f=new jj,f.Ca(c),K(f,3,!0),gg(d,3,f));Yn(I(f,3)?"Pivot table field collapsed":"Pivot table field expanded");t$(a,b,!0,!1)}}}function vwc(a,b){var c=new gj;hg(c,2);K(c,1,!1);F(b,function(a){gg(c,2,a)});K(a,2,c)}u.J=function(){nwc.G.J.call(this)};function xwc(){L.call(this)}C(xwc,Kn);xwc.prototype.k=function(){return m$};xwc.prototype.j=function(){return nwc};Sn("ritzpivottables",xwc);
